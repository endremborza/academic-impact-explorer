import{s as xe,e as we,i as w,d as p,N as At,O as nt,r as Pe,a as te,u as je,h as z,c as ie,j as d,P as lt,Q as st,w as D,x as be,R as ht,A as Me,y as at,z as dt,S as Ft,f as H,g as Q,J as Pt,H as Ze,T as Nt,l as ae,m as he,n as Ae,k as Gt,U as ot,V as jt,C as Ut,E as Wt,F as Yt,G as Jt,p as Ye,D as Je,v as Kt}from"./scheduler.2d1c82f4.js";import{S as $e,i as et,g as Fe,c as Ne,a as C,t as U,b as qe,d as Oe,m as Te,h as ze,e as Ie,f as Ke}from"./index.bf293594.js";import{e as Se,u as Xt,o as Zt}from"./each.66af19a5.js";import{g as ct,a as Mt,b as xt}from"./style-util.70c21ca4.js";import{f as Ce}from"./index.e8025cb1.js";import{g as Ht,D as _t,d as $t,a as ei,b as ti,p as ii,c as ri}from"./tree-functions.2607c0ac.js";import{f as tt}from"./text-format-util.e81a9716.js";import{M as it}from"./constants.8d8a1d0f.js";import{B as Qt}from"./BrokenFittedText.2ee271a1.js";import{g as ni}from"./visual-util.fb52d494.js";/* empty css                                             */import{P as li}from"./PathLevelInfoBox.d0ec457a.js";const Hi={"qc-6c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries"},{attribute_kind:"sources",resolver_id:"w2qs",description:"1-w2qs-1"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"}],root_entity_type:"countries"},"qc-8":{bifurcations:[{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"0-concept-hierarchy-1"},{attribute_kind:"qs",resolver_id:"w2qs",description:"0-w2qs-0"},{attribute_kind:"sources",resolver_id:"w2qs",description:"0-w2qs-1"}],root_entity_type:"institutions"},"qc-5c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1"},{attribute_kind:"sources",resolver_id:"w2qs",description:"1-w2qs-1"}],root_entity_type:"countries"},"qc-7":{bifurcations:[{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"0-country-hierarchy-0"},{attribute_kind:"institutions",resolver_id:"country-hierarchy",description:"0-country-hierarchy-1"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"0-concept-hierarchy-0"},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"0-concept-hierarchy-1"}],root_entity_type:"institutions"},"qc-2c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries"},{attribute_kind:"qs",resolver_id:"w2qs",description:"0-w2qs-0"},{attribute_kind:"sources",resolver_id:"w2qs",description:"0-w2qs-1"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0"}],root_entity_type:"countries"},"qc-3c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0"},{attribute_kind:"institutions",resolver_id:"country-hierarchy",description:"1-country-hierarchy-1"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"}],root_entity_type:"countries"},"qc-7c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"0-country-hierarchy-0"},{attribute_kind:"institutions",resolver_id:"country-hierarchy",description:"0-country-hierarchy-1"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"0-concept-hierarchy-0"}],root_entity_type:"countries"},"qc-6":{bifurcations:[{attribute_kind:"sources",resolver_id:"w2qs",description:"1-w2qs-1"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"}],root_entity_type:"institutions"},"qc-8c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries"},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"0-concept-hierarchy-1"},{attribute_kind:"qs",resolver_id:"w2qs",description:"0-w2qs-0"},{attribute_kind:"sources",resolver_id:"w2qs",description:"0-w2qs-1"}],root_entity_type:"countries"},"qc-1c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"0-country-hierarchy-0"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1"}],root_entity_type:"countries"},"qc-4":{bifurcations:[{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"0-concept-hierarchy-0"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0"},{attribute_kind:"institutions",resolver_id:"country-hierarchy",description:"1-country-hierarchy-1"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"}],root_entity_type:"institutions"},"qc-2":{bifurcations:[{attribute_kind:"qs",resolver_id:"w2qs",description:"0-w2qs-0"},{attribute_kind:"sources",resolver_id:"w2qs",description:"0-w2qs-1"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"}],root_entity_type:"institutions"},"qc-4c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"0-concept-hierarchy-0"},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0"},{attribute_kind:"institutions",resolver_id:"country-hierarchy",description:"1-country-hierarchy-1"}],root_entity_type:"countries"},"qc-3":{bifurcations:[{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0"},{attribute_kind:"institutions",resolver_id:"country-hierarchy",description:"1-country-hierarchy-1"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1"}],root_entity_type:"institutions"},"qc-5":{bifurcations:[{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1"},{attribute_kind:"sources",resolver_id:"w2qs",description:"1-w2qs-1"}],root_entity_type:"institutions"},"qc-1":{bifurcations:[{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"0-country-hierarchy-0"},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0"},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1"}],root_entity_type:"institutions"}};function Qe(i,e,t,o,c){return()=>{i("ti",{path:t,action:e,topLeftCorner:{x:o,y:c}})}}function pt(i,e,t){const o=i.slice();return o[43]=e[t].id,o[44]=e[t].cachedProps,o[45]=e[t].vizInfo,o[46]=e[t].childNode,o[47]=e[t].textShape,o[48]=e[t].hoverShape,o}function gt(i,e,t){const o=i.slice();return o[51]=e[t][0],o[52]=e[t][1],o}function bt(i){let e,t,o;return{c(){e=Pe("stop"),this.h()},l(c){e=je(c,"stop",{offset:!0,"stop-opacity":!0,"stop-color":!0,class:!0}),z(e).forEach(p),this.h()},h(){d(e,"offset",i[51]+"%"),d(e,"stop-opacity",t=i[46].isSelected?"80%":`${i[52]}%`),d(e,"stop-color",o=i[45].colorStr),d(e,"class","svelte-1cwbp37")},m(c,l){w(c,e,l)},p(c,l){l[0]&8192&&t!==(t=c[46].isSelected?"80%":`${c[52]}%`)&&d(e,"stop-opacity",t),l[0]&8192&&o!==(o=c[45].colorStr)&&d(e,"stop-color",o)},d(c){c&&p(e)}}}function mt(i){let e,t;const o=[i[44],{qcSpec:i[0]},{attributeLabels:i[1]},{visibleTreeInfo:i[2]},{selectionState:i[3]},{levelOutSpecs:i[4]},{treeD2:i[5]},{treeD2Offset:i[9]},{childD1Rate:i[6]},{overHangRate:i[7]},{preStraightRate:i[8]},{childBaseSize:i[10]},{linkSurfaceRate:i[11]},{childrenInternalMargin:i[12]},{parentSideMargin:0}];let c={};for(let l=0;l<o.length;l+=1)c=nt(c,o[l]);return e=new Vt({props:c}),e.$on("ti",i[33]),{c(){qe(e.$$.fragment)},l(l){Oe(e.$$.fragment,l)},m(l,r){Te(e,l,r),t=!0},p(l,r){const s=r[0]&16383?ct(o,[r[0]&8192&&Mt(l[44]),r[0]&1&&{qcSpec:l[0]},r[0]&2&&{attributeLabels:l[1]},r[0]&4&&{visibleTreeInfo:l[2]},r[0]&8&&{selectionState:l[3]},r[0]&16&&{levelOutSpecs:l[4]},r[0]&32&&{treeD2:l[5]},r[0]&512&&{treeD2Offset:l[9]},r[0]&64&&{childD1Rate:l[6]},r[0]&128&&{overHangRate:l[7]},r[0]&256&&{preStraightRate:l[8]},r[0]&1024&&{childBaseSize:l[10]},r[0]&2048&&{linkSurfaceRate:l[11]},r[0]&4096&&{childrenInternalMargin:l[12]},o[14]]):{};e.$set(s)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){U(e.$$.fragment,l),t=!1},d(l){Ie(e,l)}}}function yt(i,e){let t,o,c,l,r,s,a,u,_,g,v,f,m,k,L,re,$,W=Se([[0,5],[20,15],[50,25]]),P=[];for(let b=0;b<3;b+=1)P[b]=bt(gt(e,W,b));const ue=[{text:e[46].name},e[47]];let ne={};for(let b=0;b<ue.length;b+=1)ne=nt(ne,ue[b]);g=new Qt({props:ne});let j=[e[48],{"fill-opacity":"0"}],V={};for(let b=0;b<j.length;b+=1)V=nt(V,j[b]);let T=e[46].children&&mt(e);return{key:i,first:null,c(){t=Pe("defs"),o=Pe("linearGradient");for(let b=0;b<3;b+=1)P[b].c();l=te(),r=Pe("path"),_=te(),qe(g.$$.fragment),v=te(),f=Pe("rect"),m=te(),T&&T.c(),k=we(),this.h()},l(b){t=je(b,"defs",{});var S=z(t);o=je(S,"linearGradient",{id:!0,gradientTransform:!0});var I=z(o);for(let O=0;O<3;O+=1)P[O].l(I);I.forEach(p),S.forEach(p),l=ie(b),r=je(b,"path",{d:!0,fill:!0,class:!0}),z(r).forEach(p),_=ie(b),Oe(g.$$.fragment,b),v=ie(b),f=je(b,"rect",{"fill-opacity":!0}),z(f).forEach(p),m=ie(b),T&&T.l(b),k=we(),this.h()},h(){d(o,"id",c="path-grad-"+e[45].strId),d(o,"gradientTransform","rotate(90)"),d(r,"d",s=e[45].linkPath),d(r,"fill",a="url('#path-grad-"+e[45].strId+"')"),d(r,"class","svelte-1cwbp37"),lt(f,V),st(f,"svelte-1cwbp37",!0),this.first=t},m(b,S){w(b,t,S),D(t,o);for(let I=0;I<3;I+=1)P[I]&&P[I].m(o,null);w(b,l,S),w(b,r,S),w(b,_,S),Te(g,b,S),w(b,v,S),w(b,f,S),w(b,m,S),T&&T.m(b,S),w(b,k,S),L=!0,re||($=[be(f,"mouseover",function(){ht(Qe(e[14],"highlight",e[44].pathInCompleteTree,e[48].x,e[48].y))&&Qe(e[14],"highlight",e[44].pathInCompleteTree,e[48].x,e[48].y).apply(this,arguments)}),be(f,"mouseleave",function(){ht(Qe(e[14],"de-highlight",e[44].pathInCompleteTree,0,0))&&Qe(e[14],"de-highlight",e[44].pathInCompleteTree,0,0).apply(this,arguments)}),be(f,"click",function(){ht(Qe(e[14],"toggle-select",e[44].pathInCompleteTree,0,0))&&Qe(e[14],"toggle-select",e[44].pathInCompleteTree,0,0).apply(this,arguments)})],re=!0)},p(b,S){if(e=b,S[0]&8192){W=Se([[0,5],[20,15],[50,25]]);let O;for(O=0;O<3;O+=1){const oe=gt(e,W,O);P[O]?P[O].p(oe,S):(P[O]=bt(oe),P[O].c(),P[O].m(o,null))}for(;O<3;O+=1)P[O].d(1)}(!L||S[0]&8192&&c!==(c="path-grad-"+e[45].strId))&&d(o,"id",c),(!L||S[0]&8192&&s!==(s=e[45].linkPath))&&d(r,"d",s),(!L||S[0]&8192&&a!==(a="url('#path-grad-"+e[45].strId+"')"))&&d(r,"fill",a);const I=S[0]&8192?ct(ue,[{text:e[46].name},Mt(e[47])]):{};g.$set(I),lt(f,V=ct(j,[S[0]&8192&&e[48],{"fill-opacity":"0"}])),st(f,"svelte-1cwbp37",!0),e[46].children?T?(T.p(e,S),S[0]&8192&&C(T,1)):(T=mt(e),T.c(),C(T,1),T.m(k.parentNode,k)):T&&(Fe(),U(T,1,1,()=>{T=null}),Ne())},i(b){L||(b&&Me(()=>{L&&(u||(u=ze(r,Ce,{duration:300},!0)),u.run(1))}),C(g.$$.fragment,b),C(T),L=!0)},o(b){b&&(u||(u=ze(r,Ce,{duration:300},!1)),u.run(0)),U(g.$$.fragment,b),U(T),L=!1},d(b){b&&(p(t),p(l),p(r),p(_),p(v),p(f),p(m),p(k)),at(P,b),b&&u&&u.end(),Ie(g,b),T&&T.d(b),re=!1,dt($)}}}function si(i){let e=[],t=new Map,o,c,l=Se(i[13]);const r=s=>s[43];for(let s=0;s<l.length;s+=1){let a=pt(i,l,s),u=r(a);t.set(u,e[s]=yt(u,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();o=we()},l(s){for(let a=0;a<e.length;a+=1)e[a].l(s);o=we()},m(s,a){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(s,a);w(s,o,a),c=!0},p(s,a){a[0]&32767&&(l=Se(s[13]),Fe(),e=Xt(e,a,r,1,s,l,t,o.parentNode,Zt,yt,o,pt),Ne())},i(s){if(!c){for(let a=0;a<l.length;a+=1)C(e[a]);c=!0}},o(s){for(let a=0;a<e.length;a+=1)U(e[a]);c=!1},d(s){s&&p(o);for(let a=0;a<e.length;a+=1)e[a].d(s)}}}function vt(i,e,t,o,c,l,r){const s=_=>c*(_||0)/l,a=o+s(e),u=i+((t==null?void 0:t.rank)||0)*(o+r)+s(t==null?void 0:t.weight);return{rootD2:a,d2Offset:u}}function oi(i,e,t){let o,c,l,r,s,a,u,_,g,v,f,m,k,L,re,$,W,P,ue,ne,{qcSpec:j}=e,{attributeLabels:V}=e,{visibleTreeInfo:T}=e,{selectionState:b}=e,{levelOutSpecs:S=[]}=e,{pathInCompleteTree:I=[]}=e,{branchReachBack:O=0}=e,{rootD2:oe=30}=e,{treeD2:me=70}=e,{childD1Rate:fe=.2}=e,{overHangRate:Y=.05}=e,{preStraightRate:N=.05}=e,{treeD2Offset:G=0}=e,{childBaseSize:de=2.9}=e,{linkSurfaceRate:se=.8}=e,{childrenInternalMargin:ce=.9}=e,{parentSideMargin:J=.8}=e,{d2Offset:pe=(me-oe)/2+G}=e;const K=At(),De=y=>y===void 0?0:y;function Re(y,le){var Le;const _e={pathInCompleteTree:[...I,y],...vt(G,le.weight,le==null?void 0:le.totalOffsetOnLevel,de,ue,((Le=T.meta[c])==null?void 0:Le.totalWeight)||1,ce)},Be=vt(pe+J,le.weight,le==null?void 0:le.totalOffsetAmongSiblings,P,$*(r>1?se:1)-P*r,(l==null?void 0:l.childrenSumWeight)||1,W),ve={parent:Be.rootD2,child:_e.rootD2},ye=g+(le.isSelected?f:0),B={x:Be.d2Offset,y:m},Ue={x:_e.d2Offset,y:k};let M=ni(B,Ue,ve,ye,re),X={x:_e.d2Offset+ve.child*.18,y:L-g*.05,height:g*.9,width:ve.child*.64};const Z={x:_e.d2Offset,y:k,height:g,width:ve.child};return{id:y,cachedProps:_e,vizInfo:{linkPath:M,d2Size:ve.child,colorStr:xt(le.scaleEnds.mid),strId:_e.pathInCompleteTree.join("-")},childNode:le,textShape:X,hoverShape:Z}}function Ge(y,le){return Object.entries((y==null?void 0:y.children)||{}).map(([_e,Be])=>Re(_e,Be))}function He(y){Ft.call(this,i,y)}return i.$$set=y=>{"qcSpec"in y&&t(0,j=y.qcSpec),"attributeLabels"in y&&t(1,V=y.attributeLabels),"visibleTreeInfo"in y&&t(2,T=y.visibleTreeInfo),"selectionState"in y&&t(3,b=y.selectionState),"levelOutSpecs"in y&&t(4,S=y.levelOutSpecs),"pathInCompleteTree"in y&&t(15,I=y.pathInCompleteTree),"branchReachBack"in y&&t(16,O=y.branchReachBack),"rootD2"in y&&t(17,oe=y.rootD2),"treeD2"in y&&t(5,me=y.treeD2),"childD1Rate"in y&&t(6,fe=y.childD1Rate),"overHangRate"in y&&t(7,Y=y.overHangRate),"preStraightRate"in y&&t(8,N=y.preStraightRate),"treeD2Offset"in y&&t(9,G=y.treeD2Offset),"childBaseSize"in y&&t(10,de=y.childBaseSize),"linkSurfaceRate"in y&&t(11,se=y.linkSurfaceRate),"childrenInternalMargin"in y&&t(12,ce=y.childrenInternalMargin),"parentSideMargin"in y&&t(18,J=y.parentSideMargin),"d2Offset"in y&&t(19,pe=y.d2Offset)},i.$$.update=()=>{var y;i.$$.dirty[0]&32768&&t(32,o=I.length),i.$$.dirty[1]&2&&t(27,c=o+1),i.$$.dirty[0]&32772&&t(21,l=Ht(I,T.tree)),i.$$.dirty[0]&2097152&&t(25,r=Object.keys((l==null?void 0:l.children)||{}).length),i.$$.dirty[0]&16|i.$$.dirty[1]&2&&t(20,s=S[o]),i.$$.dirty[0]&134217732&&t(28,a=((y=T.meta[c])==null?void 0:y.totalNodes)||0),i.$$.dirty[0]&1048576&&t(31,u=De(s==null?void 0:s.topOffset)),i.$$.dirty[0]&1049024&&t(30,[_,g,v,f]=[1-fe-N-Y,fe,N,Y].map(le=>De((s==null?void 0:s.totalSize)*le)),_,(t(22,g),t(6,fe),t(8,N),t(7,Y),t(20,s),t(4,S),t(32,o),t(15,I)),(t(29,v),t(6,fe),t(8,N),t(7,Y),t(20,s),t(4,S),t(32,o),t(15,I))),i.$$.dirty[0]&536870912|i.$$.dirty[1]&1&&t(24,m=u+v),i.$$.dirty[0]&1090519040&&t(23,k=m+_),i.$$.dirty[0]&12582912&&(L=k+g),i.$$.dirty[0]&536936448&&(re=O+v),i.$$.dirty[0]&393216&&t(26,$=oe-2*J),i.$$.dirty[0]&100665344&&(W=$*(1-se)/(r>1?r-1:1)),i.$$.dirty[0]&100665344&&(P=$*se/(r*1.8)),i.$$.dirty[0]&268440608&&(ue=me-de*a-ce*(a-1)),i.$$.dirty[0]&3145728&&t(13,ne=Ge(l))},[j,V,T,b,S,me,fe,Y,N,G,de,se,ce,ne,K,I,O,oe,J,pe,s,l,g,k,m,r,$,c,a,v,_,u,o,He]}class Vt extends $e{constructor(e){super(),et(this,e,oi,si,xe,{qcSpec:0,attributeLabels:1,visibleTreeInfo:2,selectionState:3,levelOutSpecs:4,pathInCompleteTree:15,branchReachBack:16,rootD2:17,treeD2:5,childD1Rate:6,overHangRate:7,preStraightRate:8,treeD2Offset:9,childBaseSize:10,linkSurfaceRate:11,childrenInternalMargin:12,parentSideMargin:18,d2Offset:19},null,[-1,-1])}}function ci(i){let e,t,o,c,l="<span>−</span><span>+</span>",r,s,a,u;return{c(){e=H("div"),t=H("input"),o=te(),c=H("label"),c.innerHTML=l,this.h()},l(_){e=Q(_,"DIV",{class:!0});var g=z(e);t=Q(g,"INPUT",{type:!0,min:!0,max:!0,class:!0}),o=ie(g),c=Q(g,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Pt(c)!=="svelte-3lai9p"&&(c.innerHTML=l),g.forEach(p),this.h()},h(){d(t,"type","range"),d(t,"min",i[1]),d(t,"max",i[2]),d(t,"class","svelte-1gdj9q3"),d(c,"for","topn-input"),d(c,"class","svelte-1gdj9q3"),d(e,"class","vert-zero svelte-1gdj9q3")},m(_,g){w(_,e,g),D(e,t),Ze(t,i[0]),D(e,o),D(e,c),s=!0,a||(u=[be(t,"change",i[4]),be(t,"input",i[4])],a=!0)},p(_,[g]){i=_,(!s||g&2)&&d(t,"min",i[1]),(!s||g&4)&&d(t,"max",i[2]),g&1&&Ze(t,i[0])},i(_){s||(_&&Me(()=>{s&&(r||(r=ze(e,Ce,{duration:i[3]},!0)),r.run(1))}),s=!0)},o(_){_&&(r||(r=ze(e,Ce,{duration:i[3]},!1)),r.run(0)),s=!1},d(_){_&&p(e),_&&r&&r.end(),a=!1,dt(u)}}}function ai(i,e,t){let{value:o}=e,{min:c}=e,{max:l}=e,{duration:r=400}=e;function s(){o=Nt(this.value),t(0,o)}return i.$$set=a=>{"value"in a&&t(0,o=a.value),"min"in a&&t(1,c=a.min),"max"in a&&t(2,l=a.max),"duration"in a&&t(3,r=a.duration)},[o,c,l,r,s]}class hi extends $e{constructor(e){super(),et(this,e,ai,ci,xe,{value:0,min:1,max:2,duration:3})}}function kt(i,e,t){const o=i.slice();return o[7]=e[t],o}function wt(i){let e,t,o,c=i[5](i[0][i[2]]||"").split("<")[0]+"",l,r,s,a,u,_,g,v,f=i[1].levelOptions.length>1&&St(i);return{c(){e=H("div"),t=H("div"),o=H("span"),l=ae(c),s=te(),f&&f.c(),a=te(),u=H("div"),this.h()},l(m){e=Q(m,"DIV",{class:!0,style:!0});var k=z(e);t=Q(k,"DIV",{class:!0});var L=z(t);o=Q(L,"SPAN",{class:!0});var re=z(o);l=he(re,c),re.forEach(p),L.forEach(p),s=ie(k),f&&f.l(k),a=ie(k),u=Q(k,"DIV",{class:!0}),z(u).forEach(p),k.forEach(p),this.h()},h(){d(o,"class","svelte-1hzgw1i"),d(t,"class",r="sel-base sel-cover "+(i[1].levelOptions.length>1?"sel-clicky":"")+" svelte-1hzgw1i"),d(u,"class","bg filler svelte-1hzgw1i"),d(e,"class","sentenceline svelte-1hzgw1i"),d(e,"style",_=i[4]({top:i[1].topOffset+i[1].totalSize*.2+i[3],height:i[1].totalSize*.25},{},{}))},m(m,k){w(m,e,k),D(e,t),D(t,o),D(o,l),D(e,s),f&&f.m(e,null),D(e,a),D(e,u),v=!0},p(m,k){(!v||k&5)&&c!==(c=m[5](m[0][m[2]]||"").split("<")[0]+"")&&Ae(l,c),(!v||k&2&&r!==(r="sel-base sel-cover "+(m[1].levelOptions.length>1?"sel-clicky":"")+" svelte-1hzgw1i"))&&d(t,"class",r),m[1].levelOptions.length>1?f?f.p(m,k):(f=St(m),f.c(),f.m(e,a)):f&&(f.d(1),f=null),(!v||k&26&&_!==(_=m[4]({top:m[1].topOffset+m[1].totalSize*.2+m[3],height:m[1].totalSize*.25},{},{})))&&d(e,"style",_)},i(m){v||(m&&Me(()=>{v&&(g||(g=ze(e,Ce,{duration:400},!0)),g.run(1))}),v=!0)},o(m){m&&(g||(g=ze(e,Ce,{duration:400},!1)),g.run(0)),v=!1},d(m){m&&p(e),f&&f.d(),m&&g&&g.end()}}}function St(i){let e,t,o,c=Se(i[1].levelOptions),l=[];for(let r=0;r<c.length;r+=1)l[r]=qt(kt(i,c,r));return{c(){e=H("select");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=Q(r,"SELECT",{class:!0,style:!0});var s=z(e);for(let a=0;a<l.length;a+=1)l[a].l(s);s.forEach(p),this.h()},h(){d(e,"class","sel-base svelte-1hzgw1i"),Gt(e,"opacity","0"),i[0][i[2]]===void 0&&Me(()=>i[6].call(e))},m(r,s){w(r,e,s);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null);ot(e,i[0][i[2]],!0),t||(o=be(e,"change",i[6]),t=!0)},p(r,s){if(s&34){c=Se(r[1].levelOptions);let a;for(a=0;a<c.length;a+=1){const u=kt(r,c,a);l[a]?l[a].p(u,s):(l[a]=qt(u),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=c.length}s&7&&ot(e,r[0][r[2]])},d(r){r&&p(e),at(l,r),t=!1,o()}}}function qt(i){let e,t=i[5](i[7])+"",o,c,l;return{c(){e=H("option"),o=ae(t),c=te(),this.h()},l(r){e=Q(r,"OPTION",{class:!0});var s=z(e);o=he(s,t),c=ie(s),s.forEach(p),this.h()},h(){e.__value=l=i[7],Ze(e,e.__value),d(e,"class","svelte-1hzgw1i")},m(r,s){w(r,e,s),D(e,o),D(e,c)},p(r,s){s&2&&t!==(t=r[5](r[7])+"")&&Ae(o,t),s&2&&l!==(l=r[7])&&(e.__value=l,Ze(e,e.__value))},d(r){r&&p(e)}}}function ui(i){let e,t=i[1].isVisible&&wt(i);return{c(){t&&t.c(),e=we()},l(o){t&&t.l(o),e=we()},m(o,c){t&&t.m(o,c),w(o,e,c)},p(o,[c]){o[1].isVisible?t?(t.p(o,c),c&2&&C(t,1)):(t=wt(o),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(Fe(),U(t,1,1,()=>{t=null}),Ne())},i(o){C(t)},o(o){U(t)},d(o){o&&p(e),t&&t.d(o)}}}function fi(i,e,t){let{levelSpec:o}=e,{index:c}=e,{selectedBreakdowns:l}=e,{totalD1Offset:r}=e,{dBasedStyle:s}=e;function a(_){let g=l[0]=="1-w2qs-1",v=l[0]=="agged-institutions-to-countries",f={"agged-institutions-to-countries":"working at"},m=v?Math.max(c-1,0):c;return[{"0-concept-hierarchy-0":"working on <field>","0-concept-hierarchy-1":"working on <subfield>","1-concept-hierarchy-0":"are cited by papers in <field>","0-country-hierarchy-0":"co-author with scholars working in <country>","1-country-hierarchy-0":"are cited by authors working in <country>","0-w2qs-0":"publish in journals categorized as <q#>","1-w2qs-1":"are cited in papers published in <journal>"},{"1-concept-hierarchy-0":"and are cited by authors working on","1-concept-hierarchy-1":"and in particular","0-country-hierarchy-1":"working at","1-country-hierarchy-0":(g?"":"are cited ")+"by authors in","1-country-hierarchy-1":"at","0-w2qs-0":"publish in journals categorized as","0-w2qs-1":"such as"},{"0-concept-hierarchy-0":"focused on","1-concept-hierarchy-1":"and in particular in","1-country-hierarchy-1":"working at","1-concept-hierarchy-0":(g?"working ":"")+"on","0-w2qs-1":"such as","1-w2qs-1":"published in","1-country-hierarchy-0":"and are cited by authors working in"},{"0-concept-hierarchy-1":"and in particular","1-concept-hierarchy-0":"on","1-concept-hierarchy-1":"and in particular"},{}][m][_]||f[_]||_}function u(){l[c]=jt(this),t(0,l),t(1,o)}return i.$$set=_=>{"levelSpec"in _&&t(1,o=_.levelSpec),"index"in _&&t(2,c=_.index),"selectedBreakdowns"in _&&t(0,l=_.selectedBreakdowns),"totalD1Offset"in _&&t(3,r=_.totalD1Offset),"dBasedStyle"in _&&t(4,s=_.dBasedStyle)},[l,o,c,r,s,a,u]}class di extends $e{constructor(e){super(),et(this,e,fi,ui,xe,{levelSpec:1,index:2,selectedBreakdowns:0,totalD1Offset:3,dBasedStyle:4})}}function Ot(i){let e,t,o;return{c(){e=H("input"),this.h()},l(c){e=Q(c,"INPUT",{type:!0}),this.h()},h(){d(e,"type","checkbox")},m(c,l){w(c,e,l),e.checked=i[1],t||(o=be(e,"change",i[9]),t=!0)},p(c,l){l&2&&(e.checked=c[1])},d(c){c&&p(e),t=!1,o()}}}function _i(i){let e,t,o="i",c,l,r,s,a,u;const _=i[5].default,g=Ut(_,i,i[4],null);let v=i[2]&&Ot(i);return{c(){e=H("div"),t=H("span"),t.textContent=o,c=te(),l=H("span"),g&&g.c(),r=te(),v&&v.c(),this.h()},l(f){e=Q(f,"DIV",{id:!0,class:!0});var m=z(e);t=Q(m,"SPAN",{id:!0,class:!0,"data-svelte-h":!0}),Pt(t)!=="svelte-6462kx"&&(t.textContent=o),c=ie(m),l=Q(m,"SPAN",{id:!0,class:!0});var k=z(l);g&&g.l(k),k.forEach(p),r=ie(m),v&&v.l(m),m.forEach(p),this.h()},h(){d(t,"id","spec-info-hover"),d(t,"class","small-hover svelte-1cmmek4"),d(l,"id","spec-label"),d(l,"class","small-hover svelte-1cmmek4"),d(e,"id","spec-container"),d(e,"class","svelte-1cmmek4")},m(f,m){w(f,e,m),D(e,t),D(e,c),D(e,l),g&&g.m(l,null),D(e,r),v&&v.m(e,null),s=!0,a||(u=[be(t,"mouseover",i[6]),be(t,"mouseleave",i[7]),be(l,"click",i[8])],a=!0)},p(f,[m]){g&&g.p&&(!s||m&16)&&Wt(g,_,f,f[4],s?Jt(_,f[4],m,null):Yt(f[4]),null),f[2]?v?v.p(f,m):(v=Ot(f),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i(f){s||(C(g,f),s=!0)},o(f){U(g,f),s=!1},d(f){f&&p(e),g&&g.d(f),v&&v.d(),a=!1,dt(u)}}}function pi(i,e,t){let{$$slots:o={},$$scope:c}=e,{hoverToggle:l}=e,{checked:r}=e,{checkBox:s=!0}=e,{interactText:a=!0}=e;const u=()=>{t(0,l=!0)},_=()=>{t(0,l=!1)},g=()=>{a&&t(1,r=!r)};function v(){r=this.checked,t(1,r)}return i.$$set=f=>{"hoverToggle"in f&&t(0,l=f.hoverToggle),"checked"in f&&t(1,r=f.checked),"checkBox"in f&&t(2,s=f.checkBox),"interactText"in f&&t(3,a=f.interactText),"$$scope"in f&&t(4,c=f.$$scope)},[l,r,s,a,c,o,u,_,g,v]}class Tt extends $e{constructor(e){super(),et(this,e,pi,_i,xe,{hoverToggle:0,checked:1,checkBox:2,interactText:3})}}function It(i,e,t){const o=i.slice();return o[56]=e[t],o[58]=t,o}function Dt(i,e,t){const o=i.slice();return o[59]=e[t],o}function Rt(i){var Le;let e,t,o,c,l,r,s,a,u,_,g,v,f,m,k=tt(i[8].source_count||0,0)+"",L,re,$=tt(i[8].weight||0,0)+"",W,P,ue,ne,j,V,T,b,S,I,O,oe,me,fe,Y,N,G,de,se,ce,J,pe,K;t=new Vt({props:{qcSpec:i[3],branchReachBack:i[11]*ke/100,d2Offset:i[26]+rt,rootD2:ut,attributeLabels:i[1],visibleTreeInfo:i[12],selectionState:i[9],levelOutSpecs:i[18],treeD2:Xe-rt,treeD2Offset:rt,childD1Rate:i[24],overHangRate:ki,childBaseSize:wi}}),t.$on("ti",i[27]);let De=[{id:"qc-header"},i[21],{rx:"0.4"}],Re={};for(let n=0;n<De.length;n+=1)Re=nt(Re,De[n]);c=new Qt({props:{height:i[21].height*.7,width:i[21].width*.8,text:((Le=i[19])==null?void 0:Le.name)||"",anchor:"middle",bottomAligned:!1,x:i[21].x+i[21].width/2,y:i[21].y+i[21].height*.75,allowRotation:!1}});function Ge(n){i[39](n)}let He={min:1,max:Si};i[6]!==void 0&&(He.value=i[6]),V=new hi({props:He}),Ye.push(()=>Ke(V,"value",Ge));function y(n){i[40](n)}function le(n){i[41](n)}let _e={$$slots:{default:[gi]},$$scope:{ctx:i}};i[16]!==void 0&&(_e.hoverToggle=i[16]),i[7]!==void 0&&(_e.checked=i[7]),O=new Tt({props:_e}),Ye.push(()=>Ke(O,"hoverToggle",y)),Ye.push(()=>Ke(O,"checked",le));function Be(n){i[43](n)}let ve={interactText:!1,checked:!1,checkBox:!1,$$slots:{default:[bi]},$$scope:{ctx:i}};i[17]!==void 0&&(ve.hoverToggle=i[17]),Y=new Tt({props:ve}),Ye.push(()=>Ke(Y,"hoverToggle",Be));let ye=Se(i[18]||[]),B=[];for(let n=0;n<ye.length;n+=1)B[n]=Et(It(i,ye,n));const Ue=n=>U(B[n],1,1,()=>{B[n]=null});let M=i[14].length>0&&zt(i),X=i[16]&&Ct(i),Z=i[17]&&Lt(i);return{c(){e=Pe("svg"),qe(t.$$.fragment),o=Pe("rect"),qe(c.$$.fragment),r=te(),s=H("div"),a=H("p"),u=ae(i[2]),g=te(),v=H("div"),f=H("p"),m=ae("("),L=ae(k),re=ae(" papers, "),W=ae($),P=ae(" citations)"),ne=te(),j=H("div"),qe(V.$$.fragment),S=te(),I=H("div"),qe(O.$$.fragment),fe=te(),qe(Y.$$.fragment),de=te();for(let n=0;n<B.length;n+=1)B[n].c();se=te(),M&&M.c(),ce=te(),X&&X.c(),J=te(),Z&&Z.c(),pe=we(),this.h()},l(n){e=je(n,"svg",{viewBox:!0,xmlns:!0,class:!0});var h=z(e);Oe(t.$$.fragment,h),o=je(h,"rect",{id:!0,rx:!0}),z(o).forEach(p),Oe(c.$$.fragment,h),h.forEach(p),r=ie(n),s=Q(n,"DIV",{class:!0,style:!0});var q=z(s);a=Q(q,"P",{id:!0,class:!0});var ee=z(a);u=he(ee,i[2]),ee.forEach(p),q.forEach(p),g=ie(n),v=Q(n,"DIV",{class:!0,style:!0});var A=z(v);f=Q(A,"P",{id:!0,class:!0});var R=z(f);m=he(R,"("),L=he(R,k),re=he(R," papers, "),W=he(R,$),P=he(R," citations)"),R.forEach(p),A.forEach(p),ne=ie(n),j=Q(n,"DIV",{class:!0,style:!0});var x=z(j);Oe(V.$$.fragment,x),x.forEach(p),S=ie(n),I=Q(n,"DIV",{class:!0,id:!0,style:!0});var E=z(I);Oe(O.$$.fragment,E),fe=ie(E),Oe(Y.$$.fragment,E),E.forEach(p),de=ie(n);for(let F=0;F<B.length;F+=1)B[F].l(n);se=ie(n),M&&M.l(n),ce=ie(n),X&&X.l(n),J=ie(n),Z&&Z.l(n),pe=we(),this.h()},h(){lt(o,Re),st(o,"svelte-1eprj6g",!0),d(e,"viewBox",l=i[20].x+" "+i[20].y+" "+i[20].width+" "+i[20].height),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"class","svelte-1eprj6g"),d(a,"id","sentence-starter"),d(a,"class","svelte-1eprj6g"),d(s,"class","floater sentence-container svelte-1eprj6g"),d(s,"style",_=i[23]({top:0},{left:20,width:60},{height:Ve})),d(f,"id","num-stat-subtitle"),d(f,"class","svelte-1eprj6g"),d(v,"class","floater sentence-container svelte-1eprj6g"),d(v,"style",ue=i[23]({},{left:i[21].x-i[21].width/2,width:i[21].width*2},{height:ke*.15,top:ke*.85+Ve})),d(j,"class","floater svelte-1eprj6g"),d(j,"style",b=i[23]({top:i[22]+i[21].height*.5,height:0},{left:Ee,width:i[26]*.82},{})),d(I,"class","floater svelte-1eprj6g"),d(I,"id","right-control"),d(I,"style",G=i[23]({top:i[22],height:i[21].height},{right:Ee,width:100-i[21].width-i[26]-Ee-Ee},{}))},m(n,h){w(n,e,h),Te(t,e,null),D(e,o),Te(c,e,null),w(n,r,h),w(n,s,h),D(s,a),D(a,u),w(n,g,h),w(n,v,h),D(v,f),D(f,m),D(f,L),D(f,re),D(f,W),D(f,P),w(n,ne,h),w(n,j,h),Te(V,j,null),w(n,S,h),w(n,I,h),Te(O,I,null),D(I,fe),Te(Y,I,null),w(n,de,h);for(let q=0;q<B.length;q+=1)B[q]&&B[q].m(n,h);w(n,se,h),M&&M.m(n,h),w(n,ce,h),X&&X.m(n,h),w(n,J,h),Z&&Z.m(n,h),w(n,pe,h),K=!0},p(n,h){var E;const q={};h[0]&8&&(q.qcSpec=n[3]),h[0]&2048&&(q.branchReachBack=n[11]*ke/100),h[0]&2&&(q.attributeLabels=n[1]),h[0]&4096&&(q.visibleTreeInfo=n[12]),h[0]&512&&(q.selectionState=n[9]),h[0]&262144&&(q.levelOutSpecs=n[18]),h[0]&16777216&&(q.childD1Rate=n[24]),t.$set(q),lt(o,Re=ct(De,[{id:"qc-header"},h[0]&2097152&&n[21],{rx:"0.4"}])),st(o,"svelte-1eprj6g",!0);const ee={};h[0]&2097152&&(ee.height=n[21].height*.7),h[0]&2097152&&(ee.width=n[21].width*.8),h[0]&524288&&(ee.text=((E=n[19])==null?void 0:E.name)||""),h[0]&2097152&&(ee.x=n[21].x+n[21].width/2),h[0]&2097152&&(ee.y=n[21].y+n[21].height*.75),c.$set(ee),(!K||h[0]&1048576&&l!==(l=n[20].x+" "+n[20].y+" "+n[20].width+" "+n[20].height))&&d(e,"viewBox",l),(!K||h[0]&4)&&Ae(u,n[2]),(!K||h[0]&8388608&&_!==(_=n[23]({top:0},{left:20,width:60},{height:Ve})))&&d(s,"style",_),(!K||h[0]&256)&&k!==(k=tt(n[8].source_count||0,0)+"")&&Ae(L,k),(!K||h[0]&256)&&$!==($=tt(n[8].weight||0,0)+"")&&Ae(W,$),(!K||h[0]&10485760&&ue!==(ue=n[23]({},{left:n[21].x-n[21].width/2,width:n[21].width*2},{height:ke*.15,top:ke*.85+Ve})))&&d(v,"style",ue);const A={};!T&&h[0]&64&&(T=!0,A.value=n[6],Je(()=>T=!1)),V.$set(A),(!K||h[0]&14680064&&b!==(b=n[23]({top:n[22]+n[21].height*.5,height:0},{left:Ee,width:n[26]*.82},{})))&&d(j,"style",b);const R={};h[2]&1&&(R.$$scope={dirty:h,ctx:n}),!oe&&h[0]&65536&&(oe=!0,R.hoverToggle=n[16],Je(()=>oe=!1)),!me&&h[0]&128&&(me=!0,R.checked=n[7],Je(()=>me=!1)),O.$set(R);const x={};if(h[0]&1|h[2]&1&&(x.$$scope={dirty:h,ctx:n}),!N&&h[0]&131072&&(N=!0,x.hoverToggle=n[17],Je(()=>N=!1)),Y.$set(x),(!K||h[0]&14680064&&G!==(G=n[23]({top:n[22],height:n[21].height},{right:Ee,width:100-n[21].width-n[26]-Ee-Ee},{})))&&d(I,"style",G),h[0]&14943232){ye=Se(n[18]||[]);let F;for(F=0;F<ye.length;F+=1){const We=It(n,ye,F);B[F]?(B[F].p(We,h),C(B[F],1)):(B[F]=Et(We),B[F].c(),C(B[F],1),B[F].m(se.parentNode,se))}for(Fe(),F=ye.length;F<B.length;F+=1)Ue(F);Ne()}n[14].length>0?M?(M.p(n,h),h[0]&16384&&C(M,1)):(M=zt(n),M.c(),C(M,1),M.m(ce.parentNode,ce)):M&&(Fe(),U(M,1,1,()=>{M=null}),Ne()),n[16]?X?X.p(n,h):(X=Ct(n),X.c(),X.m(J.parentNode,J)):X&&(X.d(1),X=null),n[17]?Z?Z.p(n,h):(Z=Lt(n),Z.c(),Z.m(pe.parentNode,pe)):Z&&(Z.d(1),Z=null)},i(n){if(!K){C(t.$$.fragment,n),C(c.$$.fragment,n),C(V.$$.fragment,n),C(O.$$.fragment,n),C(Y.$$.fragment,n);for(let h=0;h<ye.length;h+=1)C(B[h]);C(M),K=!0}},o(n){U(t.$$.fragment,n),U(c.$$.fragment,n),U(V.$$.fragment,n),U(O.$$.fragment,n),U(Y.$$.fragment,n),B=B.filter(Boolean);for(let h=0;h<B.length;h+=1)U(B[h]);U(M),K=!1},d(n){n&&(p(e),p(r),p(s),p(g),p(v),p(ne),p(j),p(S),p(I),p(de),p(se),p(ce),p(J),p(pe)),Ie(t),Ie(c),Ie(V),Ie(O),Ie(Y),at(B,n),M&&M.d(n),X&&X.d(n),Z&&Z.d(n)}}}function gi(i){let e;return{c(){e=ae("Specialization")},l(t){e=he(t,"Specialization")},m(t,o){w(t,e,o)},d(t){t&&p(e)}}}function Bt(i){let e,t=i[59]+"",o;return{c(){e=H("option"),o=ae(t),this.h()},l(c){e=Q(c,"OPTION",{});var l=z(e);o=he(l,t),l.forEach(p),this.h()},h(){e.__value=i[59],Ze(e,e.__value)},m(c,l){w(c,e,l),D(e,o)},p:Kt,d(c){c&&p(e)}}}function bi(i){let e,t,o,c,l=Se(i[25]),r=[];for(let s=0;s<l.length;s+=1)r[s]=Bt(Dt(i,l,s));return{c(){e=ae(`Since
			`),t=H("select");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=he(s,`Since
			`),t=Q(s,"SELECT",{});var a=z(t);for(let u=0;u<r.length;u+=1)r[u].l(a);a.forEach(p),this.h()},h(){i[0]===void 0&&Me(()=>i[42].call(t))},m(s,a){w(s,e,a),w(s,t,a);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(t,null);ot(t,i[0],!0),o||(c=be(t,"change",i[42]),o=!0)},p(s,a){if(a[0]&33554432){l=Se(s[25]);let u;for(u=0;u<l.length;u+=1){const _=Dt(s,l,u);r[u]?r[u].p(_,a):(r[u]=Bt(_),r[u].c(),r[u].m(t,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=l.length}a[0]&33554433&&ot(t,s[0])},d(s){s&&(p(e),p(t)),at(r,s),o=!1,c()}}}function Et(i){let e,t,o;function c(r){i[44](r)}let l={index:i[58],levelSpec:i[56],totalD1Offset:i[21].height+i[22],dBasedStyle:i[23]};return i[10]!==void 0&&(l.selectedBreakdowns=i[10]),e=new di({props:l}),Ye.push(()=>Ke(e,"selectedBreakdowns",c)),{c(){qe(e.$$.fragment)},l(r){Oe(e.$$.fragment,r)},m(r,s){Te(e,r,s),o=!0},p(r,s){const a={};s[0]&262144&&(a.levelSpec=r[56]),s[0]&6291456&&(a.totalD1Offset=r[21].height+r[22]),s[0]&8388608&&(a.dBasedStyle=r[23]),!t&&s[0]&1024&&(t=!0,a.selectedBreakdowns=r[10],Je(()=>t=!1)),e.$set(a)},i(r){o||(C(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){Ie(e,r)}}}function zt(i){let e,t,o,c,l,r,s;return t=new li({props:{path:i[14],weightedRoot:i[8],qcSpec:i[3],rootId:i[15],attributeLabels:i[1],showPaper:i[13]}}),{c(){e=H("div"),qe(t.$$.fragment),this.h()},l(a){e=Q(a,"DIV",{class:!0,style:!0});var u=z(e);Oe(t.$$.fragment,u),u.forEach(p),this.h()},h(){d(e,"class","hoverover clickable svelte-1eprj6g"),d(e,"style",o=i[23]({},{right:2,width:96},{bottom:1,height:ft/(i[13]?.5:2)}))},m(a,u){w(a,e,u),Te(t,e,null),l=!0,r||(s=be(e,"click",i[45]),r=!0)},p(a,u){const _={};u[0]&16384&&(_.path=a[14]),u[0]&256&&(_.weightedRoot=a[8]),u[0]&8&&(_.qcSpec=a[3]),u[0]&32768&&(_.rootId=a[15]),u[0]&2&&(_.attributeLabels=a[1]),u[0]&8192&&(_.showPaper=a[13]),t.$set(_),(!l||u[0]&8396800&&o!==(o=a[23]({},{right:2,width:96},{bottom:1,height:ft/(a[13]?.5:2)})))&&d(e,"style",o)},i(a){l||(C(t.$$.fragment,a),a&&Me(()=>{l&&(c||(c=ze(e,Ce,{duration:200},!0)),c.run(1))}),l=!0)},o(a){U(t.$$.fragment,a),a&&(c||(c=ze(e,Ce,{duration:200},!1)),c.run(0)),l=!1},d(a){a&&p(e),Ie(t),a&&c&&c.end(),r=!1,s()}}}function Ct(i){let e,t,o;return{c(){e=H("div"),t=ae(`Specialization is calculated using the expected prevelance of a country, source, or concept,
			and comparing it to the one present in the current breakdown flow. If it is switched off, the
			sheer volume of citations is considered.`),this.h()},l(c){e=Q(c,"DIV",{class:!0,id:!0,style:!0});var l=z(e);t=he(l,`Specialization is calculated using the expected prevelance of a country, source, or concept,
			and comparing it to the one present in the current breakdown flow. If it is switched off, the
			sheer volume of citations is considered.`),l.forEach(p),this.h()},h(){d(e,"class","floater hoverover svelte-1eprj6g"),d(e,"id","spec-hover"),d(e,"style",o=i[23]({top:i[22]+i[21].height},{left:i[26]+i[21].width*.2,width:i[21].width*1.6},{}))},m(c,l){w(c,e,l),D(e,t)},p(c,l){l[0]&14680064&&o!==(o=c[23]({top:c[22]+c[21].height},{left:c[26]+c[21].width*.2,width:c[21].width*1.6},{}))&&d(e,"style",o)},d(c){c&&p(e)}}}function Lt(i){let e,t,o,c,l;return{c(){e=H("div"),t=ae("Filter the underlying dataset to papers published in or after "),o=ae(i[0]),c=ae("."),this.h()},l(r){e=Q(r,"DIV",{class:!0,id:!0,style:!0});var s=z(e);t=he(s,"Filter the underlying dataset to papers published in or after "),o=he(s,i[0]),c=he(s,"."),s.forEach(p),this.h()},h(){d(e,"class","floater hoverover svelte-1eprj6g"),d(e,"id","spec-hover"),d(e,"style",l=i[23]({top:i[22]+i[21].height*1.1},{left:i[26]+i[21].width*.2,width:i[21].width*1.6},{}))},m(r,s){w(r,e,s),D(e,t),D(e,o),D(e,c)},p(r,s){s[0]&1&&Ae(o,r[0]),s[0]&14680064&&l!==(l=r[23]({top:r[22]+r[21].height*1.1},{left:r[26]+r[21].width*.2,width:r[21].width*1.6},{}))&&d(e,"style",l)},d(r){r&&p(e)}}}function mi(i){let e=!Object.values(i[20]).includes(NaN)&&!Object.values(i[20]).includes(void 0),t,o,c,l;Me(i[38]);let r=e&&Rt(i);return{c(){r&&r.c(),t=we()},l(s){r&&r.l(s),t=we()},m(s,a){r&&r.m(s,a),w(s,t,a),o=!0,c||(l=be(window,"resize",i[38]),c=!0)},p(s,a){a[0]&1048576&&(e=!Object.values(s[20]).includes(NaN)&&!Object.values(s[20]).includes(void 0)),e?r?(r.p(s,a),a[0]&1048576&&C(r,1)):(r=Rt(s),r.c(),C(r,1),r.m(t.parentNode,t)):r&&(Fe(),U(r,1,1,()=>{r=null}),Ne())},i(s){o||(C(r),o=!0)},o(s){U(r),o=!1},d(s){s&&p(t),r&&r.d(s),c=!1,l()}}}const yi=2004;let vi=.3,Xe=100,ut=25,rt=0,Ee=3,Ve=9,ft=20,ke=11,ki=.05,wi=2.5,Si=15;function qi(i,e){return(t,o,c)=>[[t||{},i,"px"],[o||{},e,"px"],[c||{},l=>l,"svh"]].map(([l,r,s])=>Object.entries(l).map(([a,u])=>`${a}: ${r(u)}${s};`).join("")).join("")}function Oi(i,e,t){let o,c,l,r,s,a,u,_,g,v,f;const m=[2004,2019,2020,2021,2022,2023];let{defaultQcSpecId:k}=e,{selectedQcRootId:L}=e,{rootType:re}=e,{attributeLabels:$}=e,{fullQcSpecs:W}=e,{removeHighlightUnhover:P=!0}=e,{startSentence:ue="Scholars at"}=e,{specFilterYear:ne=2004}=e,j=!1,V,T,b=[],S=L,I,O,oe,me=(Xe-ut)/2.5,fe=!1,Y=!1,N=Array(it).fill(0).map(()=>({totalSize:0,topOffset:0,levelOptions:[],isVisible:!1})),G=Array(it).fill(0).map(()=>({..._t})),de=_t.limit_n,se=!0,ce={weight:1,source_count:1,top_source:[0,0]},J={children:{}},pe,K=De(k,W);function De(n,h){var A;if(n==null)return[];const q=[],ee=h[n];for(let R=0;R<it;R++)q.push(((A=ee.bifurcations[R])==null?void 0:A.description)||"");return q}function Re(n,h){let q={};for(let[ee,A]of Object.entries(n))if(A.root_entity_type==h){t(28,W[ee]=A,W);let R=q;for(let x of A.bifurcations){const E=x.description;E in R||(R[E]={children:{},qcSpecs:[]}),R[E].qcSpecs.push(ee),R=R[E].children}}return q}function Ge(n){for(let h in G)t(33,G[h].limit_n=n,G)}function He(n){for(let h in G)t(33,G[h].size_base=n?"specialization":"volume",G)}function y(n,h,q,ee){if(t(13,j=!1),h==null||n.length==0)return;let A=0,R=c,x;for(let E of n){if(x=R[E],x===void 0)return;if(x.qcSpecs.includes(V))A++;else break;R=x.children}for(V=(x==null?void 0:x.qcSpecs[0])||"";n.length>0;)n.pop();for(let E of W[V].bifurcations)n.push(E.description);for(let E=A;E<G.length;E++)t(33,G[E].include=[],G);t(19,pe=q[re][L]),ei(`qc-builds/${ee}/${V}/${h}`,E=>{t(8,[ce,J,T,S]=[E,ti(ii(J,A),E),W[V],h],ce,t(9,J),t(3,T),t(15,S))})}function le(n,h,q,ee,A){var We;if(t(13,j=!1),A.length==0)return;let R=1;for(let ge of(n.meta||[]).slice(2))ge.totalNodes>0&&R++;let x=ee,E=0;const F=q===void 0?h/R:h/R/2;for(let ge=0;ge<it;ge++)t(18,N[ge].totalSize=q==ge?h/2+F:F,N),t(18,N[ge].topOffset=E,N),t(18,N[ge].levelOptions=Object.keys(x),N),t(18,N[ge].isVisible=ge<R,N),E+=N[ge].totalSize,ge==R-1&&(E+=h/2),x=((We=x[A[ge]])==null?void 0:We.children)||{}}function _e(n){var A;const h=n[n.length-1];let q=Ht(n.slice(0,n.length-1),J);if((q==null?void 0:q.children)===void 0)return;Object.keys(q.children).includes(h)?(delete q.children[h],ri(J)):q.children[h]={children:((A=q.children[h])==null?void 0:A.children)||{}},t(13,j=!1),t(9,J)}function Be(n){const h=n.detail.path,q=n.detail.action;if(q=="highlight"){t(14,b=h),t(13,j=!1);return}else if(q=="de-highlight"){P&&t(14,b=[]);return}_e(h)}function ve(){t(5,oe=window.innerWidth),t(4,O=window.innerHeight)}function ye(n){de=n,t(6,de)}function B(n){fe=n,t(16,fe)}function Ue(n){se=n,t(7,se)}function M(){ne=jt(this),t(0,ne),t(25,m)}function X(n){Y=n,t(17,Y)}function Z(n){K=n,t(10,K)}const Le=()=>{t(13,j=!j)};return i.$$set=n=>{"defaultQcSpecId"in n&&t(29,k=n.defaultQcSpecId),"selectedQcRootId"in n&&t(30,L=n.selectedQcRootId),"rootType"in n&&t(31,re=n.rootType),"attributeLabels"in n&&t(1,$=n.attributeLabels),"fullQcSpecs"in n&&t(28,W=n.fullQcSpecs),"removeHighlightUnhover"in n&&t(32,P=n.removeHighlightUnhover),"startSentence"in n&&t(2,ue=n.startSentence),"specFilterYear"in n&&t(0,ne=n.specFilterYear)},i.$$.update=()=>{i.$$.dirty[0]&1&&t(35,o=ne==yi?"all":`y-${ne}`),i.$$.dirty[0]&268435456|i.$$.dirty[1]&1&&t(34,c=Re(W,re)),i.$$.dirty[0]&48&&t(11,r=O/oe*Xe),i.$$.dirty[0]&2064&&t(37,s=n=>n*O/r),i.$$.dirty[0]&32&&t(36,a=n=>n*oe/Xe),i.$$.dirty[1]&96&&t(23,u=qi(s,a)),i.$$.dirty[0]&2048&&t(22,_=Ve*r/100),i.$$.dirty[0]&2048&&t(21,g={height:r*ke/100,width:ut,x:me+rt,y:-r*ke/100}),i.$$.dirty[0]&2048&&t(20,v={height:r,width:Xe,x:0,y:-(ke+Ve)*r/100}),i.$$.dirty[0]&1073742850|i.$$.dirty[1]&16&&y(K,L,$,o),i.$$.dirty[0]&64&&Ge(de),i.$$.dirty[0]&128&&He(se),i.$$.dirty[0]&778|i.$$.dirty[1]&4&&t(12,f=$t(ce,G,J,$,T)),i.$$.dirty[0]&7168|i.$$.dirty[1]&8&&le(f,r*(1-(ke+ft)/100),I,c,K)},t(24,l=vi),[ne,$,ue,T,O,oe,de,se,ce,J,K,r,f,j,b,S,fe,Y,N,pe,v,g,_,u,l,m,me,Be,W,k,L,re,P,G,c,o,a,s,ve,ye,B,Ue,M,X,Z,Le]}class Qi extends $e{constructor(e){super(),et(this,e,Oi,mi,xe,{defaultQcSpecId:29,selectedQcRootId:30,rootType:31,attributeLabels:1,fullQcSpecs:28,removeHighlightUnhover:32,startSentence:2,specFilterYear:0},null,[-1,-1,-1])}}export{Qi as F,Hi as f};
