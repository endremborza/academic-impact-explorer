import{s as Ze,e as Oe,i as O,d as g,N as At,O as lt,r as Me,a as x,u as He,h as L,c as $,j as _,P as rt,Q as nt,w as R,x as ge,R as ct,A as Qe,y as at,z as ut,S as Ft,f as V,g as N,J as jt,H as Xe,T as Gt,l as ae,m as ce,n as Fe,k as Ut,U as st,V as Mt,C as Wt,E as Yt,F as Jt,G as Kt,p as We,D as Ye,v as Xt}from"./scheduler.2d1c82f4.js";import{S as xe,i as $e,g as Ge,c as Ue,a as P,t as J,b as qe,d as Re,m as Be,h as Ce,e as Ee,f as Je}from"./index.bf293594.js";import{e as Te,u as Zt,o as xt}from"./each.66af19a5.js";import{g as ot,a as Ht,b as $t}from"./style-util.70c21ca4.js";import{f as Pe}from"./index.e8025cb1.js";import{g as Qt,D as _t,d as ei,a as ti,b as ii,p as li,c as ri}from"./tree-functions.2607c0ac.js";import{f as et}from"./text-format-util.e81a9716.js";import{M as tt}from"./constants.8d8a1d0f.js";import{B as Vt}from"./BrokenFittedText.2ee271a1.js";import{g as ni}from"./visual-util.fb52d494.js";/* empty css                                             */import{P as si}from"./PathLevelInfoBox.d0ec457a.js";const Qi={"qca-1":{bifurcations:[{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"0-concept-hierarchy-0",source_side:!0},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0",source_side:!1},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1",source_side:!1}],root_entity_type:"authors"},"qca-2":{bifurcations:[{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0",source_side:!1},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1",source_side:!1},{attribute_kind:"sources",resolver_id:"w2qs",description:"1-w2qs-1",source_side:!1}],root_entity_type:"authors"},"qc-1c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries",source_side:!0},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"0-country-hierarchy-0",source_side:!0},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0",source_side:!1},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1",source_side:!1}],root_entity_type:"countries"},"qca-5":{bifurcations:[{attribute_kind:"sources",resolver_id:"w2qs",description:"1-w2qs-1",source_side:!1},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0",source_side:!1},{attribute_kind:"institutions",resolver_id:"country-hierarchy",description:"1-country-hierarchy-1",source_side:!1}],root_entity_type:"authors"},"qc-2":{bifurcations:[{attribute_kind:"qs",resolver_id:"w2qs",description:"0-w2qs-0",source_side:!0},{attribute_kind:"sources",resolver_id:"w2qs",description:"0-w2qs-1",source_side:!0},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0",source_side:!1},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0",source_side:!1}],root_entity_type:"institutions"},"qca-3":{bifurcations:[{attribute_kind:"sources",resolver_id:"w2qs",description:"0-w2qs-1",source_side:!0},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0",source_side:!1},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0",source_side:!1}],root_entity_type:"authors"},"qca-4":{bifurcations:[{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0",source_side:!1},{attribute_kind:"institutions",resolver_id:"country-hierarchy",description:"1-country-hierarchy-1",source_side:!1},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0",source_side:!1},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1",source_side:!1}],root_entity_type:"authors"},"qc-2c":{bifurcations:[{attribute_kind:"institutions",resolver_id:"agged-institutions-to-countries",description:"agged-institutions-to-countries",source_side:!0},{attribute_kind:"qs",resolver_id:"w2qs",description:"0-w2qs-0",source_side:!0},{attribute_kind:"sources",resolver_id:"w2qs",description:"0-w2qs-1",source_side:!0},{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"1-country-hierarchy-0",source_side:!1}],root_entity_type:"countries"},"qc-1":{bifurcations:[{attribute_kind:"countries",resolver_id:"country-hierarchy",description:"0-country-hierarchy-0",source_side:!0},{attribute_kind:"fields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-0",source_side:!1},{attribute_kind:"subfields",resolver_id:"concept-hierarchy",description:"1-concept-hierarchy-1",source_side:!1}],root_entity_type:"institutions"}};function Ne(i,e,t,s,o){return()=>{i("ti",{path:t,action:e,topLeftCorner:{x:s,y:o}})}}function gt(i,e,t){const s=i.slice();return s[43]=e[t].id,s[44]=e[t].cachedProps,s[45]=e[t].vizInfo,s[46]=e[t].childNode,s[47]=e[t].textShape,s[48]=e[t].hoverShape,s}function pt(i,e,t){const s=i.slice();return s[51]=e[t][0],s[52]=e[t][1],s}function mt(i){let e,t,s;return{c(){e=Me("stop"),this.h()},l(o){e=He(o,"stop",{offset:!0,"stop-opacity":!0,"stop-color":!0,class:!0}),L(e).forEach(g),this.h()},h(){_(e,"offset",i[51]+"%"),_(e,"stop-opacity",t=i[46].isSelected?"80%":`${i[52]}%`),_(e,"stop-color",s=i[45].colorStr),_(e,"class","svelte-1cwbp37")},m(o,r){O(o,e,r)},p(o,r){r[0]&8192&&t!==(t=o[46].isSelected?"80%":`${o[52]}%`)&&_(e,"stop-opacity",t),r[0]&8192&&s!==(s=o[45].colorStr)&&_(e,"stop-color",s)},d(o){o&&g(e)}}}function bt(i){let e,t;const s=[i[44],{qcSpec:i[0]},{attributeLabels:i[1]},{visibleTreeInfo:i[2]},{selectionState:i[3]},{levelOutSpecs:i[4]},{treeD2:i[5]},{treeD2Offset:i[9]},{childD1Rate:i[6]},{overHangRate:i[7]},{preStraightRate:i[8]},{childBaseSize:i[10]},{linkSurfaceRate:i[11]},{childrenInternalMargin:i[12]},{parentSideMargin:0}];let o={};for(let r=0;r<s.length;r+=1)o=lt(o,s[r]);return e=new Nt({props:o}),e.$on("ti",i[33]),{c(){qe(e.$$.fragment)},l(r){Re(e.$$.fragment,r)},m(r,l){Be(e,r,l),t=!0},p(r,l){const n=l[0]&16383?ot(s,[l[0]&8192&&Ht(r[44]),l[0]&1&&{qcSpec:r[0]},l[0]&2&&{attributeLabels:r[1]},l[0]&4&&{visibleTreeInfo:r[2]},l[0]&8&&{selectionState:r[3]},l[0]&16&&{levelOutSpecs:r[4]},l[0]&32&&{treeD2:r[5]},l[0]&512&&{treeD2Offset:r[9]},l[0]&64&&{childD1Rate:r[6]},l[0]&128&&{overHangRate:r[7]},l[0]&256&&{preStraightRate:r[8]},l[0]&1024&&{childBaseSize:r[10]},l[0]&2048&&{linkSurfaceRate:r[11]},l[0]&4096&&{childrenInternalMargin:r[12]},s[14]]):{};e.$set(n)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){J(e.$$.fragment,r),t=!1},d(r){Ee(e,r)}}}function vt(i,e){let t,s,o,r,l,n,a,f,h,p,y,u,v,S,B,ee,A,re=Te([[0,5],[20,15],[50,25]]),D=[];for(let m=0;m<3;m+=1)D[m]=mt(pt(e,re,m));const j=[{text:e[46].name},e[47]];let ne={};for(let m=0;m<j.length;m+=1)ne=lt(ne,j[m]);p=new Vt({props:ne});let te=[e[48],{"fill-opacity":"0"}],ie={};for(let m=0;m<te.length;m+=1)ie=lt(ie,te[m]);let w=e[46].children&&bt(e);return{key:i,first:null,c(){t=Me("defs"),s=Me("linearGradient");for(let m=0;m<3;m+=1)D[m].c();r=x(),l=Me("path"),h=x(),qe(p.$$.fragment),y=x(),u=Me("rect"),v=x(),w&&w.c(),S=Oe(),this.h()},l(m){t=He(m,"defs",{});var T=L(t);s=He(T,"linearGradient",{id:!0,gradientTransform:!0});var M=L(s);for(let q=0;q<3;q+=1)D[q].l(M);M.forEach(g),T.forEach(g),r=$(m),l=He(m,"path",{d:!0,fill:!0,class:!0}),L(l).forEach(g),h=$(m),Re(p.$$.fragment,m),y=$(m),u=He(m,"rect",{"fill-opacity":!0}),L(u).forEach(g),v=$(m),w&&w.l(m),S=Oe(),this.h()},h(){_(s,"id",o="path-grad-"+e[45].strId),_(s,"gradientTransform","rotate(90)"),_(l,"d",n=e[45].linkPath),_(l,"fill",a="url('#path-grad-"+e[45].strId+"')"),_(l,"class","svelte-1cwbp37"),rt(u,ie),nt(u,"svelte-1cwbp37",!0),this.first=t},m(m,T){O(m,t,T),R(t,s);for(let M=0;M<3;M+=1)D[M]&&D[M].m(s,null);O(m,r,T),O(m,l,T),O(m,h,T),Be(p,m,T),O(m,y,T),O(m,u,T),O(m,v,T),w&&w.m(m,T),O(m,S,T),B=!0,ee||(A=[ge(u,"mouseover",function(){ct(Ne(e[14],"highlight",e[44].pathInCompleteTree,e[48].x,e[48].y))&&Ne(e[14],"highlight",e[44].pathInCompleteTree,e[48].x,e[48].y).apply(this,arguments)}),ge(u,"mouseleave",function(){ct(Ne(e[14],"de-highlight",e[44].pathInCompleteTree,0,0))&&Ne(e[14],"de-highlight",e[44].pathInCompleteTree,0,0).apply(this,arguments)}),ge(u,"click",function(){ct(Ne(e[14],"toggle-select",e[44].pathInCompleteTree,0,0))&&Ne(e[14],"toggle-select",e[44].pathInCompleteTree,0,0).apply(this,arguments)})],ee=!0)},p(m,T){if(e=m,T[0]&8192){re=Te([[0,5],[20,15],[50,25]]);let q;for(q=0;q<3;q+=1){const X=pt(e,re,q);D[q]?D[q].p(X,T):(D[q]=mt(X),D[q].c(),D[q].m(s,null))}for(;q<3;q+=1)D[q].d(1)}(!B||T[0]&8192&&o!==(o="path-grad-"+e[45].strId))&&_(s,"id",o),(!B||T[0]&8192&&n!==(n=e[45].linkPath))&&_(l,"d",n),(!B||T[0]&8192&&a!==(a="url('#path-grad-"+e[45].strId+"')"))&&_(l,"fill",a);const M=T[0]&8192?ot(j,[{text:e[46].name},Ht(e[47])]):{};p.$set(M),rt(u,ie=ot(te,[T[0]&8192&&e[48],{"fill-opacity":"0"}])),nt(u,"svelte-1cwbp37",!0),e[46].children?w?(w.p(e,T),T[0]&8192&&P(w,1)):(w=bt(e),w.c(),P(w,1),w.m(S.parentNode,S)):w&&(Ge(),J(w,1,1,()=>{w=null}),Ue())},i(m){B||(m&&Qe(()=>{B&&(f||(f=Ce(l,Pe,{duration:300},!0)),f.run(1))}),P(p.$$.fragment,m),P(w),B=!0)},o(m){m&&(f||(f=Ce(l,Pe,{duration:300},!1)),f.run(0)),J(p.$$.fragment,m),J(w),B=!1},d(m){m&&(g(t),g(r),g(l),g(h),g(y),g(u),g(v),g(S)),at(D,m),m&&f&&f.end(),Ee(p,m),w&&w.d(m),ee=!1,ut(A)}}}function oi(i){let e=[],t=new Map,s,o,r=Te(i[13]);const l=n=>n[43];for(let n=0;n<r.length;n+=1){let a=gt(i,r,n),f=l(a);t.set(f,e[n]=vt(f,a))}return{c(){for(let n=0;n<e.length;n+=1)e[n].c();s=Oe()},l(n){for(let a=0;a<e.length;a+=1)e[a].l(n);s=Oe()},m(n,a){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(n,a);O(n,s,a),o=!0},p(n,a){a[0]&32767&&(r=Te(n[13]),Ge(),e=Zt(e,a,l,1,n,r,t,s.parentNode,xt,vt,s,gt),Ue())},i(n){if(!o){for(let a=0;a<r.length;a+=1)P(e[a]);o=!0}},o(n){for(let a=0;a<e.length;a+=1)J(e[a]);o=!1},d(n){n&&g(s);for(let a=0;a<e.length;a+=1)e[a].d(n)}}}function yt(i,e,t,s,o,r,l){const n=h=>o*(h||0)/r,a=s+n(e),f=i+((t==null?void 0:t.rank)||0)*(s+l)+n(t==null?void 0:t.weight);return{rootD2:a,d2Offset:f}}function ai(i,e,t){let s,o,r,l,n,a,f,h,p,y,u,v,S,B,ee,A,re,D,j,ne,{qcSpec:te}=e,{attributeLabels:ie}=e,{visibleTreeInfo:w}=e,{selectionState:m}=e,{levelOutSpecs:T=[]}=e,{pathInCompleteTree:M=[]}=e,{branchReachBack:q=0}=e,{rootD2:X=30}=e,{treeD2:fe=70}=e,{childD1Rate:le=.2}=e,{overHangRate:U=.05}=e,{preStraightRate:W=.05}=e,{treeD2Offset:Y=0}=e,{childBaseSize:C=2.9}=e,{linkSurfaceRate:pe=.8}=e,{childrenInternalMargin:me=.9}=e,{parentSideMargin:se=.8}=e,{d2Offset:Se=(fe-X)/2+Y}=e;const ve=At(),Ve=k=>k===void 0?0:k;function je(k,I){var H;const z={pathInCompleteTree:[...M,k],...yt(Y,I.weight,I==null?void 0:I.totalOffsetOnLevel,C,j,((H=w.meta[o])==null?void 0:H.totalWeight)||1,me)},F=yt(Se+se,I.weight,I==null?void 0:I.totalOffsetAmongSiblings,D,A*(l>1?pe:1)-D*l,(r==null?void 0:r.childrenSumWeight)||1,re),c={parent:F.rootD2,child:z.rootD2},d=p+(I.isSelected?u:0),K={x:F.d2Offset,y:v},ue={x:z.d2Offset,y:S};let Ie=ni(K,ue,c,d,ee),ke={x:z.d2Offset+c.child*.18,y:B-p*.05,height:p*.9,width:c.child*.64};const be={x:z.d2Offset,y:S,height:p,width:c.child};return{id:k,cachedProps:z,vizInfo:{linkPath:Ie,d2Size:c.child,colorStr:$t(I.scaleEnds.mid),strId:z.pathInCompleteTree.join("-")},childNode:I,textShape:ke,hoverShape:be}}function ye(k,I){return Object.entries((k==null?void 0:k.children)||{}).map(([z,F])=>je(z,F))}function E(k){Ft.call(this,i,k)}return i.$$set=k=>{"qcSpec"in k&&t(0,te=k.qcSpec),"attributeLabels"in k&&t(1,ie=k.attributeLabels),"visibleTreeInfo"in k&&t(2,w=k.visibleTreeInfo),"selectionState"in k&&t(3,m=k.selectionState),"levelOutSpecs"in k&&t(4,T=k.levelOutSpecs),"pathInCompleteTree"in k&&t(15,M=k.pathInCompleteTree),"branchReachBack"in k&&t(16,q=k.branchReachBack),"rootD2"in k&&t(17,X=k.rootD2),"treeD2"in k&&t(5,fe=k.treeD2),"childD1Rate"in k&&t(6,le=k.childD1Rate),"overHangRate"in k&&t(7,U=k.overHangRate),"preStraightRate"in k&&t(8,W=k.preStraightRate),"treeD2Offset"in k&&t(9,Y=k.treeD2Offset),"childBaseSize"in k&&t(10,C=k.childBaseSize),"linkSurfaceRate"in k&&t(11,pe=k.linkSurfaceRate),"childrenInternalMargin"in k&&t(12,me=k.childrenInternalMargin),"parentSideMargin"in k&&t(18,se=k.parentSideMargin),"d2Offset"in k&&t(19,Se=k.d2Offset)},i.$$.update=()=>{var k;i.$$.dirty[0]&32768&&t(32,s=M.length),i.$$.dirty[1]&2&&t(27,o=s+1),i.$$.dirty[0]&32772&&t(21,r=Qt(M,w.tree)),i.$$.dirty[0]&2097152&&t(25,l=Object.keys((r==null?void 0:r.children)||{}).length),i.$$.dirty[0]&16|i.$$.dirty[1]&2&&t(20,n=T[s]),i.$$.dirty[0]&134217732&&t(28,a=((k=w.meta[o])==null?void 0:k.totalNodes)||0),i.$$.dirty[0]&1048576&&t(31,f=Ve(n==null?void 0:n.topOffset)),i.$$.dirty[0]&1049024&&t(30,[h,p,y,u]=[1-le-W-U,le,W,U].map(I=>Ve((n==null?void 0:n.totalSize)*I)),h,(t(22,p),t(6,le),t(8,W),t(7,U),t(20,n),t(4,T),t(32,s),t(15,M)),(t(29,y),t(6,le),t(8,W),t(7,U),t(20,n),t(4,T),t(32,s),t(15,M))),i.$$.dirty[0]&536870912|i.$$.dirty[1]&1&&t(24,v=f+y),i.$$.dirty[0]&1090519040&&t(23,S=v+h),i.$$.dirty[0]&12582912&&(B=S+p),i.$$.dirty[0]&536936448&&(ee=q+y),i.$$.dirty[0]&393216&&t(26,A=X-2*se),i.$$.dirty[0]&100665344&&(re=A*(1-pe)/(l>1?l-1:1)),i.$$.dirty[0]&100665344&&(D=A*pe/(l*1.8)),i.$$.dirty[0]&268440608&&(j=fe-C*a-me*(a-1)),i.$$.dirty[0]&3145728&&t(13,ne=ye(r))},[te,ie,w,m,T,fe,le,U,W,Y,C,pe,me,ne,ve,M,q,X,se,Se,n,r,p,S,v,l,A,o,a,y,h,f,s,E]}class Nt extends xe{constructor(e){super(),$e(this,e,ai,oi,Ze,{qcSpec:0,attributeLabels:1,visibleTreeInfo:2,selectionState:3,levelOutSpecs:4,pathInCompleteTree:15,branchReachBack:16,rootD2:17,treeD2:5,childD1Rate:6,overHangRate:7,preStraightRate:8,treeD2Offset:9,childBaseSize:10,linkSurfaceRate:11,childrenInternalMargin:12,parentSideMargin:18,d2Offset:19},null,[-1,-1])}}function ci(i){let e,t,s,o,r="<span>âˆ’</span><span>+</span>",l,n,a,f;return{c(){e=V("div"),t=V("input"),s=x(),o=V("label"),o.innerHTML=r,this.h()},l(h){e=N(h,"DIV",{class:!0});var p=L(e);t=N(p,"INPUT",{type:!0,min:!0,max:!0,class:!0}),s=$(p),o=N(p,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),jt(o)!=="svelte-3lai9p"&&(o.innerHTML=r),p.forEach(g),this.h()},h(){_(t,"type","range"),_(t,"min",i[1]),_(t,"max",i[2]),_(t,"class","svelte-1gdj9q3"),_(o,"for","topn-input"),_(o,"class","svelte-1gdj9q3"),_(e,"class","vert-zero svelte-1gdj9q3")},m(h,p){O(h,e,p),R(e,t),Xe(t,i[0]),R(e,s),R(e,o),n=!0,a||(f=[ge(t,"change",i[4]),ge(t,"input",i[4])],a=!0)},p(h,[p]){i=h,(!n||p&2)&&_(t,"min",i[1]),(!n||p&4)&&_(t,"max",i[2]),p&1&&Xe(t,i[0])},i(h){n||(h&&Qe(()=>{n&&(l||(l=Ce(e,Pe,{duration:i[3]},!0)),l.run(1))}),n=!0)},o(h){h&&(l||(l=Ce(e,Pe,{duration:i[3]},!1)),l.run(0)),n=!1},d(h){h&&g(e),h&&l&&l.end(),a=!1,ut(f)}}}function fi(i,e,t){let{value:s}=e,{min:o}=e,{max:r}=e,{duration:l=400}=e;function n(){s=Gt(this.value),t(0,s)}return i.$$set=a=>{"value"in a&&t(0,s=a.value),"min"in a&&t(1,o=a.min),"max"in a&&t(2,r=a.max),"duration"in a&&t(3,l=a.duration)},[s,o,r,l,n]}class hi extends xe{constructor(e){super(),$e(this,e,fi,ci,Ze,{value:0,min:1,max:2,duration:3})}}function kt(i,e,t){const s=i.slice();return s[7]=e[t],s}function St(i){let e,t,s,o=i[5](i[0][i[2]]||"").split("<")[0]+"",r,l,n,a,f,h,p,y,u=i[1].levelOptions.length>1&&wt(i);return{c(){e=V("div"),t=V("div"),s=V("span"),r=ae(o),n=x(),u&&u.c(),a=x(),f=V("div"),this.h()},l(v){e=N(v,"DIV",{class:!0,style:!0});var S=L(e);t=N(S,"DIV",{class:!0});var B=L(t);s=N(B,"SPAN",{class:!0});var ee=L(s);r=ce(ee,o),ee.forEach(g),B.forEach(g),n=$(S),u&&u.l(S),a=$(S),f=N(S,"DIV",{class:!0}),L(f).forEach(g),S.forEach(g),this.h()},h(){_(s,"class","svelte-1hzgw1i"),_(t,"class",l="sel-base sel-cover "+(i[1].levelOptions.length>1?"sel-clicky":"")+" svelte-1hzgw1i"),_(f,"class","bg filler svelte-1hzgw1i"),_(e,"class","sentenceline svelte-1hzgw1i"),_(e,"style",h=i[4]({top:i[1].topOffset+i[1].totalSize*.2+i[3],height:i[1].totalSize*.25},{},{}))},m(v,S){O(v,e,S),R(e,t),R(t,s),R(s,r),R(e,n),u&&u.m(e,null),R(e,a),R(e,f),y=!0},p(v,S){(!y||S&5)&&o!==(o=v[5](v[0][v[2]]||"").split("<")[0]+"")&&Fe(r,o),(!y||S&2&&l!==(l="sel-base sel-cover "+(v[1].levelOptions.length>1?"sel-clicky":"")+" svelte-1hzgw1i"))&&_(t,"class",l),v[1].levelOptions.length>1?u?u.p(v,S):(u=wt(v),u.c(),u.m(e,a)):u&&(u.d(1),u=null),(!y||S&26&&h!==(h=v[4]({top:v[1].topOffset+v[1].totalSize*.2+v[3],height:v[1].totalSize*.25},{},{})))&&_(e,"style",h)},i(v){y||(v&&Qe(()=>{y&&(p||(p=Ce(e,Pe,{duration:400},!0)),p.run(1))}),y=!0)},o(v){v&&(p||(p=Ce(e,Pe,{duration:400},!1)),p.run(0)),y=!1},d(v){v&&g(e),u&&u.d(),v&&p&&p.end()}}}function wt(i){let e,t,s,o=Te(i[1].levelOptions),r=[];for(let l=0;l<o.length;l+=1)r[l]=Ot(kt(i,o,l));return{c(){e=V("select");for(let l=0;l<r.length;l+=1)r[l].c();this.h()},l(l){e=N(l,"SELECT",{class:!0,style:!0});var n=L(e);for(let a=0;a<r.length;a+=1)r[a].l(n);n.forEach(g),this.h()},h(){_(e,"class","sel-base svelte-1hzgw1i"),Ut(e,"opacity","0"),i[0][i[2]]===void 0&&Qe(()=>i[6].call(e))},m(l,n){O(l,e,n);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);st(e,i[0][i[2]],!0),t||(s=ge(e,"change",i[6]),t=!0)},p(l,n){if(n&34){o=Te(l[1].levelOptions);let a;for(a=0;a<o.length;a+=1){const f=kt(l,o,a);r[a]?r[a].p(f,n):(r[a]=Ot(f),r[a].c(),r[a].m(e,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=o.length}n&7&&st(e,l[0][l[2]])},d(l){l&&g(e),at(r,l),t=!1,s()}}}function Ot(i){let e,t=i[5](i[7])+"",s,o,r;return{c(){e=V("option"),s=ae(t),o=x(),this.h()},l(l){e=N(l,"OPTION",{class:!0});var n=L(e);s=ce(n,t),o=$(n),n.forEach(g),this.h()},h(){e.__value=r=i[7],Xe(e,e.__value),_(e,"class","svelte-1hzgw1i")},m(l,n){O(l,e,n),R(e,s),R(e,o)},p(l,n){n&2&&t!==(t=l[5](l[7])+"")&&Fe(s,t),n&2&&r!==(r=l[7])&&(e.__value=r,Xe(e,e.__value))},d(l){l&&g(e)}}}function ui(i){let e,t=i[1].isVisible&&St(i);return{c(){t&&t.c(),e=Oe()},l(s){t&&t.l(s),e=Oe()},m(s,o){t&&t.m(s,o),O(s,e,o)},p(s,[o]){s[1].isVisible?t?(t.p(s,o),o&2&&P(t,1)):(t=St(s),t.c(),P(t,1),t.m(e.parentNode,e)):t&&(Ge(),J(t,1,1,()=>{t=null}),Ue())},i(s){P(t)},o(s){J(t)},d(s){s&&g(e),t&&t.d(s)}}}function di(i,e,t){let{levelSpec:s}=e,{index:o}=e,{selectedBreakdowns:r}=e,{totalD1Offset:l}=e,{dBasedStyle:n}=e;function a(h){let p=r[0]=="1-w2qs-1",y=r[0]=="agged-institutions-to-countries",u={"agged-institutions-to-countries":"working at"},v=y?Math.max(o-1,0):o;return[{"0-concept-hierarchy-0":"working on <field>","0-concept-hierarchy-1":"working on <subfield>","1-concept-hierarchy-0":"are cited by papers in <field>","0-country-hierarchy-0":"co-author with scholars working in <country>","1-country-hierarchy-0":"are cited by authors working in <country>","0-w2qs-0":"publish in journals categorized as <q#>","0-w2qs-1":"published in <journal>","1-w2qs-1":"are cited in papers published in <journal>"},{"1-concept-hierarchy-0":"and are cited by authors working on","1-concept-hierarchy-1":"and in particular","0-country-hierarchy-1":"working at","1-country-hierarchy-0":(p?"":"are cited ")+"by authors in","1-country-hierarchy-1":"at","0-w2qs-0":"publish in journals categorized as","0-w2qs-1":"such as"},{"0-concept-hierarchy-0":"focused on","1-concept-hierarchy-1":"and in particular in","1-country-hierarchy-1":"working at","1-concept-hierarchy-0":(p?"working ":"")+"on","0-w2qs-1":"such as","1-w2qs-1":"published in","1-country-hierarchy-0":"and are cited by authors working in"},{"0-concept-hierarchy-1":"and in particular","1-concept-hierarchy-0":"on","1-concept-hierarchy-1":"and in particular"},{}][v][h]||u[h]||h}function f(){r[o]=Mt(this),t(0,r),t(1,s)}return i.$$set=h=>{"levelSpec"in h&&t(1,s=h.levelSpec),"index"in h&&t(2,o=h.index),"selectedBreakdowns"in h&&t(0,r=h.selectedBreakdowns),"totalD1Offset"in h&&t(3,l=h.totalD1Offset),"dBasedStyle"in h&&t(4,n=h.dBasedStyle)},[r,s,o,l,n,a,f]}class _i extends xe{constructor(e){super(),$e(this,e,di,ui,Ze,{levelSpec:1,index:2,selectedBreakdowns:0,totalD1Offset:3,dBasedStyle:4})}}function Tt(i){let e,t,s;return{c(){e=V("input"),this.h()},l(o){e=N(o,"INPUT",{type:!0}),this.h()},h(){_(e,"type","checkbox")},m(o,r){O(o,e,r),e.checked=i[1],t||(s=ge(e,"change",i[9]),t=!0)},p(o,r){r&2&&(e.checked=o[1])},d(o){o&&g(e),t=!1,s()}}}function gi(i){let e,t,s="i",o,r,l,n,a,f;const h=i[5].default,p=Wt(h,i,i[4],null);let y=i[2]&&Tt(i);return{c(){e=V("div"),t=V("span"),t.textContent=s,o=x(),r=V("span"),p&&p.c(),l=x(),y&&y.c(),this.h()},l(u){e=N(u,"DIV",{id:!0,class:!0});var v=L(e);t=N(v,"SPAN",{id:!0,class:!0,"data-svelte-h":!0}),jt(t)!=="svelte-6462kx"&&(t.textContent=s),o=$(v),r=N(v,"SPAN",{id:!0,class:!0});var S=L(r);p&&p.l(S),S.forEach(g),l=$(v),y&&y.l(v),v.forEach(g),this.h()},h(){_(t,"id","spec-info-hover"),_(t,"class","small-hover svelte-1cmmek4"),_(r,"id","spec-label"),_(r,"class","small-hover svelte-1cmmek4"),_(e,"id","spec-container"),_(e,"class","svelte-1cmmek4")},m(u,v){O(u,e,v),R(e,t),R(e,o),R(e,r),p&&p.m(r,null),R(e,l),y&&y.m(e,null),n=!0,a||(f=[ge(t,"mouseover",i[6]),ge(t,"mouseleave",i[7]),ge(r,"click",i[8])],a=!0)},p(u,[v]){p&&p.p&&(!n||v&16)&&Yt(p,h,u,u[4],n?Kt(h,u[4],v,null):Jt(u[4]),null),u[2]?y?y.p(u,v):(y=Tt(u),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},i(u){n||(P(p,u),n=!0)},o(u){J(p,u),n=!1},d(u){u&&g(e),p&&p.d(u),y&&y.d(),a=!1,ut(f)}}}function pi(i,e,t){let{$$slots:s={},$$scope:o}=e,{hoverToggle:r}=e,{checked:l}=e,{checkBox:n=!0}=e,{interactText:a=!0}=e;const f=()=>{t(0,r=!0)},h=()=>{t(0,r=!1)},p=()=>{a&&t(1,l=!l)};function y(){l=this.checked,t(1,l)}return i.$$set=u=>{"hoverToggle"in u&&t(0,r=u.hoverToggle),"checked"in u&&t(1,l=u.checked),"checkBox"in u&&t(2,n=u.checkBox),"interactText"in u&&t(3,a=u.interactText),"$$scope"in u&&t(4,o=u.$$scope)},[r,l,n,a,o,s,f,h,p,y]}class It extends xe{constructor(e){super(),$e(this,e,pi,gi,Ze,{hoverToggle:0,checked:1,checkBox:2,interactText:3})}}function Dt(i,e,t){const s=i.slice();return s[56]=e[t],s[58]=t,s}function qt(i,e,t){const s=i.slice();return s[59]=e[t],s}function Rt(i){let e,t,s,o,r,l,n,a,f,h,p,y,u,v,S,B,ee,A,re,D,j,ne,te,ie,w,m,T,M,q,X,fe,le,U;t=new Nt({props:{qcSpec:i[4],branchReachBack:i[12]*we/100,d2Offset:i[26]+it,rootD2:ft,attributeLabels:i[2],visibleTreeInfo:i[13],selectionState:i[10],levelOutSpecs:i[19],treeD2:Ke-it,treeD2Offset:it,childD1Rate:i[24],overHangRate:Si,childBaseSize:wi}}),t.$on("ti",i[27]);let W=[{id:"qc-header"},i[21],{rx:"0.4"}],Y={};for(let c=0;c<W.length;c+=1)Y=lt(Y,W[c]);o=new Vt({props:{height:i[21].height*.7,width:i[21].width*.8,text:i[1]||"",anchor:"middle",bottomAligned:!1,x:i[21].x+i[21].width/2,y:i[21].y+i[21].height*.75,allowRotation:!1}});let C=i[9].weight>1&&Bt(i);function pe(c){i[38](c)}let me={min:1,max:Oi};i[7]!==void 0&&(me.value=i[7]),B=new hi({props:me}),We.push(()=>Je(B,"value",pe));function se(c){i[39](c)}function Se(c){i[40](c)}let ve={$$slots:{default:[mi]},$$scope:{ctx:i}};i[17]!==void 0&&(ve.hoverToggle=i[17]),i[8]!==void 0&&(ve.checked=i[8]),j=new It({props:ve}),We.push(()=>Je(j,"hoverToggle",se)),We.push(()=>Je(j,"checked",Se));function Ve(c){i[42](c)}let je={interactText:!1,checked:!1,checkBox:!1,$$slots:{default:[bi]},$$scope:{ctx:i}};i[18]!==void 0&&(je.hoverToggle=i[18]),w=new It({props:je}),We.push(()=>Je(w,"hoverToggle",Ve));let ye=Te(i[19]||[]),E=[];for(let c=0;c<ye.length;c+=1)E[c]=zt(Dt(i,ye,c));const k=c=>J(E[c],1,1,()=>{E[c]=null});let I=i[15].length>0&&Lt(i),z=i[17]&&Ct(i),F=i[18]&&Pt(i);return{c(){e=Me("svg"),qe(t.$$.fragment),s=Me("rect"),qe(o.$$.fragment),l=x(),n=V("div"),a=V("p"),f=ae(i[3]),p=x(),y=V("div"),C&&C.c(),v=x(),S=V("div"),qe(B.$$.fragment),re=x(),D=V("div"),qe(j.$$.fragment),ie=x(),qe(w.$$.fragment),M=x();for(let c=0;c<E.length;c+=1)E[c].c();q=x(),I&&I.c(),X=x(),z&&z.c(),fe=x(),F&&F.c(),le=Oe(),this.h()},l(c){e=He(c,"svg",{viewBox:!0,xmlns:!0,class:!0});var d=L(e);Re(t.$$.fragment,d),s=He(d,"rect",{id:!0,rx:!0}),L(s).forEach(g),Re(o.$$.fragment,d),d.forEach(g),l=$(c),n=N(c,"DIV",{class:!0,style:!0});var K=L(n);a=N(K,"P",{id:!0,class:!0});var ue=L(a);f=ce(ue,i[3]),ue.forEach(g),K.forEach(g),p=$(c),y=N(c,"DIV",{class:!0,style:!0});var Ie=L(y);C&&C.l(Ie),Ie.forEach(g),v=$(c),S=N(c,"DIV",{class:!0,style:!0});var ke=L(S);Re(B.$$.fragment,ke),ke.forEach(g),re=$(c),D=N(c,"DIV",{class:!0,id:!0,style:!0});var be=L(D);Re(j.$$.fragment,be),ie=$(be),Re(w.$$.fragment,be),be.forEach(g),M=$(c);for(let H=0;H<E.length;H+=1)E[H].l(c);q=$(c),I&&I.l(c),X=$(c),z&&z.l(c),fe=$(c),F&&F.l(c),le=Oe(),this.h()},h(){rt(s,Y),nt(s,"svelte-1eprj6g",!0),_(e,"viewBox",r=i[20].x+" "+i[20].y+" "+i[20].width+" "+i[20].height),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"class","svelte-1eprj6g"),_(a,"id","sentence-starter"),_(a,"class","svelte-1eprj6g"),_(n,"class","floater sentence-container svelte-1eprj6g"),_(n,"style",h=i[23]({top:0},{left:20,width:60},{height:Ae})),_(y,"class","floater sentence-container svelte-1eprj6g"),_(y,"style",u=i[23]({},{left:i[21].x-i[21].width/2,width:i[21].width*2},{height:we*.15,top:we*.85+Ae})),_(S,"class","floater svelte-1eprj6g"),_(S,"style",A=i[23]({top:i[22]+i[21].height*.5,height:0},{left:Le,width:i[26]*.82},{})),_(D,"class","floater svelte-1eprj6g"),_(D,"id","right-control"),_(D,"style",T=i[23]({top:i[22],height:i[21].height},{right:Le,width:100-i[21].width-i[26]-Le-Le},{}))},m(c,d){O(c,e,d),Be(t,e,null),R(e,s),Be(o,e,null),O(c,l,d),O(c,n,d),R(n,a),R(a,f),O(c,p,d),O(c,y,d),C&&C.m(y,null),O(c,v,d),O(c,S,d),Be(B,S,null),O(c,re,d),O(c,D,d),Be(j,D,null),R(D,ie),Be(w,D,null),O(c,M,d);for(let K=0;K<E.length;K+=1)E[K]&&E[K].m(c,d);O(c,q,d),I&&I.m(c,d),O(c,X,d),z&&z.m(c,d),O(c,fe,d),F&&F.m(c,d),O(c,le,d),U=!0},p(c,d){const K={};d[0]&16&&(K.qcSpec=c[4]),d[0]&4096&&(K.branchReachBack=c[12]*we/100),d[0]&4&&(K.attributeLabels=c[2]),d[0]&8192&&(K.visibleTreeInfo=c[13]),d[0]&1024&&(K.selectionState=c[10]),d[0]&524288&&(K.levelOutSpecs=c[19]),d[0]&16777216&&(K.childD1Rate=c[24]),t.$set(K),rt(s,Y=ot(W,[{id:"qc-header"},d[0]&2097152&&c[21],{rx:"0.4"}])),nt(s,"svelte-1eprj6g",!0);const ue={};d[0]&2097152&&(ue.height=c[21].height*.7),d[0]&2097152&&(ue.width=c[21].width*.8),d[0]&2&&(ue.text=c[1]||""),d[0]&2097152&&(ue.x=c[21].x+c[21].width/2),d[0]&2097152&&(ue.y=c[21].y+c[21].height*.75),o.$set(ue),(!U||d[0]&1048576&&r!==(r=c[20].x+" "+c[20].y+" "+c[20].width+" "+c[20].height))&&_(e,"viewBox",r),(!U||d[0]&8)&&Fe(f,c[3]),(!U||d[0]&8388608&&h!==(h=c[23]({top:0},{left:20,width:60},{height:Ae})))&&_(n,"style",h),c[9].weight>1?C?C.p(c,d):(C=Bt(c),C.c(),C.m(y,null)):C&&(C.d(1),C=null),(!U||d[0]&10485760&&u!==(u=c[23]({},{left:c[21].x-c[21].width/2,width:c[21].width*2},{height:we*.15,top:we*.85+Ae})))&&_(y,"style",u);const Ie={};!ee&&d[0]&128&&(ee=!0,Ie.value=c[7],Ye(()=>ee=!1)),B.$set(Ie),(!U||d[0]&14680064&&A!==(A=c[23]({top:c[22]+c[21].height*.5,height:0},{left:Le,width:c[26]*.82},{})))&&_(S,"style",A);const ke={};d[2]&1&&(ke.$$scope={dirty:d,ctx:c}),!ne&&d[0]&131072&&(ne=!0,ke.hoverToggle=c[17],Ye(()=>ne=!1)),!te&&d[0]&256&&(te=!0,ke.checked=c[8],Ye(()=>te=!1)),j.$set(ke);const be={};if(d[0]&1|d[2]&1&&(be.$$scope={dirty:d,ctx:c}),!m&&d[0]&262144&&(m=!0,be.hoverToggle=c[18],Ye(()=>m=!1)),w.$set(be),(!U||d[0]&14680064&&T!==(T=c[23]({top:c[22],height:c[21].height},{right:Le,width:100-c[21].width-c[26]-Le-Le},{})))&&_(D,"style",T),d[0]&15206400){ye=Te(c[19]||[]);let H;for(H=0;H<ye.length;H+=1){const b=Dt(c,ye,H);E[H]?(E[H].p(b,d),P(E[H],1)):(E[H]=zt(b),E[H].c(),P(E[H],1),E[H].m(q.parentNode,q))}for(Ge(),H=ye.length;H<E.length;H+=1)k(H);Ue()}c[15].length>0?I?(I.p(c,d),d[0]&32768&&P(I,1)):(I=Lt(c),I.c(),P(I,1),I.m(X.parentNode,X)):I&&(Ge(),J(I,1,1,()=>{I=null}),Ue()),c[17]?z?z.p(c,d):(z=Ct(c),z.c(),z.m(fe.parentNode,fe)):z&&(z.d(1),z=null),c[18]?F?F.p(c,d):(F=Pt(c),F.c(),F.m(le.parentNode,le)):F&&(F.d(1),F=null)},i(c){if(!U){P(t.$$.fragment,c),P(o.$$.fragment,c),P(B.$$.fragment,c),P(j.$$.fragment,c),P(w.$$.fragment,c);for(let d=0;d<ye.length;d+=1)P(E[d]);P(I),U=!0}},o(c){J(t.$$.fragment,c),J(o.$$.fragment,c),J(B.$$.fragment,c),J(j.$$.fragment,c),J(w.$$.fragment,c),E=E.filter(Boolean);for(let d=0;d<E.length;d+=1)J(E[d]);J(I),U=!1},d(c){c&&(g(e),g(l),g(n),g(p),g(y),g(v),g(S),g(re),g(D),g(M),g(q),g(X),g(fe),g(le)),Ee(t),Ee(o),C&&C.d(),Ee(B),Ee(j),Ee(w),at(E,c),I&&I.d(c),z&&z.d(c),F&&F.d(c)}}}function Bt(i){let e,t,s=et(i[9].source_count||0,0)+"",o,r,l=et(i[9].weight||0,0)+"",n,a;return{c(){e=V("p"),t=ae("("),o=ae(s),r=ae(" papers, "),n=ae(l),a=ae(" citations)"),this.h()},l(f){e=N(f,"P",{id:!0,class:!0});var h=L(e);t=ce(h,"("),o=ce(h,s),r=ce(h," papers, "),n=ce(h,l),a=ce(h," citations)"),h.forEach(g),this.h()},h(){_(e,"id","num-stat-subtitle"),_(e,"class","svelte-1eprj6g")},m(f,h){O(f,e,h),R(e,t),R(e,o),R(e,r),R(e,n),R(e,a)},p(f,h){h[0]&512&&s!==(s=et(f[9].source_count||0,0)+"")&&Fe(o,s),h[0]&512&&l!==(l=et(f[9].weight||0,0)+"")&&Fe(n,l)},d(f){f&&g(e)}}}function mi(i){let e;return{c(){e=ae("Specialization")},l(t){e=ce(t,"Specialization")},m(t,s){O(t,e,s)},d(t){t&&g(e)}}}function Et(i){let e,t=i[59]+"",s;return{c(){e=V("option"),s=ae(t),this.h()},l(o){e=N(o,"OPTION",{});var r=L(e);s=ce(r,t),r.forEach(g),this.h()},h(){e.__value=i[59],Xe(e,e.__value)},m(o,r){O(o,e,r),R(e,s)},p:Xt,d(o){o&&g(e)}}}function bi(i){let e,t,s,o,r=Te(i[25]),l=[];for(let n=0;n<r.length;n+=1)l[n]=Et(qt(i,r,n));return{c(){e=ae(`Since
		`),t=V("select");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=ce(n,`Since
		`),t=N(n,"SELECT",{});var a=L(t);for(let f=0;f<l.length;f+=1)l[f].l(a);a.forEach(g),this.h()},h(){i[0]===void 0&&Qe(()=>i[41].call(t))},m(n,a){O(n,e,a),O(n,t,a);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(t,null);st(t,i[0],!0),s||(o=ge(t,"change",i[41]),s=!0)},p(n,a){if(a[0]&33554432){r=Te(n[25]);let f;for(f=0;f<r.length;f+=1){const h=qt(n,r,f);l[f]?l[f].p(h,a):(l[f]=Et(h),l[f].c(),l[f].m(t,null))}for(;f<l.length;f+=1)l[f].d(1);l.length=r.length}a[0]&33554433&&st(t,n[0])},d(n){n&&(g(e),g(t)),at(l,n),s=!1,o()}}}function zt(i){let e,t,s;function o(l){i[43](l)}let r={index:i[58],levelSpec:i[56],totalD1Offset:i[21].height+i[22],dBasedStyle:i[23]};return i[11]!==void 0&&(r.selectedBreakdowns=i[11]),e=new _i({props:r}),We.push(()=>Je(e,"selectedBreakdowns",o)),{c(){qe(e.$$.fragment)},l(l){Re(e.$$.fragment,l)},m(l,n){Be(e,l,n),s=!0},p(l,n){const a={};n[0]&524288&&(a.levelSpec=l[56]),n[0]&6291456&&(a.totalD1Offset=l[21].height+l[22]),n[0]&8388608&&(a.dBasedStyle=l[23]),!t&&n[0]&2048&&(t=!0,a.selectedBreakdowns=l[11],Ye(()=>t=!1)),e.$set(a)},i(l){s||(P(e.$$.fragment,l),s=!0)},o(l){J(e.$$.fragment,l),s=!1},d(l){Ee(e,l)}}}function Lt(i){let e,t,s,o,r,l,n;return t=new si({props:{path:i[15],weightedRoot:i[9],qcSpec:i[4],rootId:i[16],attributeLabels:i[2],showPaper:i[14]}}),{c(){e=V("div"),qe(t.$$.fragment),this.h()},l(a){e=N(a,"DIV",{class:!0,style:!0});var f=L(e);Re(t.$$.fragment,f),f.forEach(g),this.h()},h(){_(e,"class","hoverover clickable svelte-1eprj6g"),_(e,"style",s=i[23]({},{right:2,width:96},{bottom:1,height:ht/(i[14]?.5:2)}))},m(a,f){O(a,e,f),Be(t,e,null),r=!0,l||(n=ge(e,"click",i[44]),l=!0)},p(a,f){const h={};f[0]&32768&&(h.path=a[15]),f[0]&512&&(h.weightedRoot=a[9]),f[0]&16&&(h.qcSpec=a[4]),f[0]&65536&&(h.rootId=a[16]),f[0]&4&&(h.attributeLabels=a[2]),f[0]&16384&&(h.showPaper=a[14]),t.$set(h),(!r||f[0]&8404992&&s!==(s=a[23]({},{right:2,width:96},{bottom:1,height:ht/(a[14]?.5:2)})))&&_(e,"style",s)},i(a){r||(P(t.$$.fragment,a),a&&Qe(()=>{r&&(o||(o=Ce(e,Pe,{duration:200},!0)),o.run(1))}),r=!0)},o(a){J(t.$$.fragment,a),a&&(o||(o=Ce(e,Pe,{duration:200},!1)),o.run(0)),r=!1},d(a){a&&g(e),Ee(t),a&&o&&o.end(),l=!1,n()}}}function Ct(i){let e,t,s;return{c(){e=V("div"),t=ae(`Specialization is calculated using the expected prevelance of a country, source, or concept,
	and comparing it to the one present in the current breakdown flow. If it is switched off, the
	sheer volume of citations is considered.`),this.h()},l(o){e=N(o,"DIV",{class:!0,id:!0,style:!0});var r=L(e);t=ce(r,`Specialization is calculated using the expected prevelance of a country, source, or concept,
	and comparing it to the one present in the current breakdown flow. If it is switched off, the
	sheer volume of citations is considered.`),r.forEach(g),this.h()},h(){_(e,"class","floater hoverover svelte-1eprj6g"),_(e,"id","spec-hover"),_(e,"style",s=i[23]({top:i[22]+i[21].height},{left:i[26]+i[21].width*.2,width:i[21].width*1.6},{}))},m(o,r){O(o,e,r),R(e,t)},p(o,r){r[0]&14680064&&s!==(s=o[23]({top:o[22]+o[21].height},{left:o[26]+o[21].width*.2,width:o[21].width*1.6},{}))&&_(e,"style",s)},d(o){o&&g(e)}}}function Pt(i){let e,t,s,o,r;return{c(){e=V("div"),t=ae("Filter the underlying dataset to papers published in or after "),s=ae(i[0]),o=ae("."),this.h()},l(l){e=N(l,"DIV",{class:!0,id:!0,style:!0});var n=L(e);t=ce(n,"Filter the underlying dataset to papers published in or after "),s=ce(n,i[0]),o=ce(n,"."),n.forEach(g),this.h()},h(){_(e,"class","floater hoverover svelte-1eprj6g"),_(e,"id","spec-hover"),_(e,"style",r=i[23]({top:i[22]+i[21].height*1.1},{left:i[26]+i[21].width*.2,width:i[21].width*1.6},{}))},m(l,n){O(l,e,n),R(e,t),R(e,s),R(e,o)},p(l,n){n[0]&1&&Fe(s,l[0]),n[0]&14680064&&r!==(r=l[23]({top:l[22]+l[21].height*1.1},{left:l[26]+l[21].width*.2,width:l[21].width*1.6},{}))&&_(e,"style",r)},d(l){l&&g(e)}}}function vi(i){let e=!Object.values(i[20]).includes(NaN)&&!Object.values(i[20]).includes(void 0),t,s,o,r;Qe(i[37]);let l=e&&Rt(i);return{c(){l&&l.c(),t=Oe()},l(n){l&&l.l(n),t=Oe()},m(n,a){l&&l.m(n,a),O(n,t,a),s=!0,o||(r=ge(window,"resize",i[37]),o=!0)},p(n,a){a[0]&1048576&&(e=!Object.values(n[20]).includes(NaN)&&!Object.values(n[20]).includes(void 0)),e?l?(l.p(n,a),a[0]&1048576&&P(l,1)):(l=Rt(n),l.c(),P(l,1),l.m(t.parentNode,t)):l&&(Ge(),J(l,1,1,()=>{l=null}),Ue())},i(n){s||(P(l),s=!0)},o(n){J(l),s=!1},d(n){n&&g(t),l&&l.d(n),o=!1,r()}}}const yi=2004;let ki=.3,Ke=100,ft=25,it=0,Le=3,Ae=9,ht=20,we=11,Si=.05,wi=2.5,Oi=15;function Ti(i,e){return(t,s,o)=>[[t||{},i,"px"],[s||{},e,"px"],[o||{},r=>r,"svh"]].map(([r,l,n])=>Object.entries(r).map(([a,f])=>`${a}: ${l(f)}${n};`).join("")).join("")}function Ii(i,e,t){let s,o,r,l,n,a,f,h,p,y;const u=[2004,2019,2020,2021,2022,2023];let{defaultQcSpecId:v}=e,{selectedQcRootId:S}=e,{rootType:B}=e,{attributeLabels:ee}=e,{fullQcSpecs:A}=e,{removeHighlightUnhover:re=!0}=e,{startSentence:D="Scholars at"}=e,{specFilterYear:j=2004}=e,{rootName:ne=""}=e,te=!1,ie,w,m=[],T=S,M,q,X,fe=(Ke-ft)/2.5,le=!1,U=!1,W=Array(tt).fill(0).map(()=>({totalSize:0,topOffset:0,levelOptions:[],isVisible:!1})),Y=Array(tt).fill(0).map(()=>({..._t})),C=_t.limit_n,pe=!0,me={weight:1,source_count:1,top_source:[0,0]},se={children:{}},Se,ve=Ve(v,A);function Ve(b,Q){var he;if(b==null)return[];const G=[],De=Q[b];for(let Z=0;Z<tt;Z++)G.push(((he=De.bifurcations[Z])==null?void 0:he.description)||"");return G}function je(b,Q){let G={};for(let[De,he]of Object.entries(b))if(he.root_entity_type==Q){t(28,A[De]=he,A);let Z=G;for(let ze of he.bifurcations){const oe=ze.description;oe in Z||(Z[oe]={children:{},qcSpecs:[]}),Z[oe].qcSpecs.push(De),Z=Z[oe].children}}return G}function ye(b){for(let Q in Y)t(33,Y[Q].limit_n=b,Y)}function E(b){for(let Q in Y)t(33,Y[Q].size_base=b?"specialization":"volume",Y)}function k(b,Q,G,De,he){if(t(14,te=!1),Q==null||b.length==0)return;let Z=0,ze=je(A,G),oe;for(let de of b){if(oe=ze[de],oe===void 0)break;if(oe.qcSpecs.includes(ie))Z++;else break;ze=oe.children}for(oe!=null?ie=oe.qcSpecs[0]:ie=v;b.length>0;)b.pop();for(let de of A[ie].bifurcations)b.push(de.description);for(let de=Z;de<Y.length;de++)t(33,Y[de].include=[],Y);Se=De[G][S],ti(`qc-builds/${he}/${ie}/${Q}`,de=>{t(9,[me,se,w,T,ne]=[de,ii(li(se,Z),de),A[ie],Q,Se==null?void 0:Se.name],me,t(10,se),t(4,w),t(16,T),t(1,ne))})}function I(b,Q,G,De,he){var dt;if(t(14,te=!1),he.length==0)return;let Z=1;for(let _e of(b.meta||[]).slice(2))_e.totalNodes>0&&Z++;let ze=De,oe=0;const de=G===void 0?Q/Z:Q/Z/2;for(let _e=0;_e<tt;_e++)t(19,W[_e].totalSize=G==_e?Q/2+de:de,W),t(19,W[_e].topOffset=oe,W),t(19,W[_e].levelOptions=Object.keys(ze),W),t(19,W[_e].isVisible=_e<Z,W),oe+=W[_e].totalSize,_e==Z-1&&(oe+=Q/2),ze=((dt=ze[he[_e]])==null?void 0:dt.children)||{}}function z(b){var he;const Q=b[b.length-1];let G=Qt(b.slice(0,b.length-1),se);if((G==null?void 0:G.children)===void 0)return;Object.keys(G.children).includes(Q)?(delete G.children[Q],ri(se)):G.children[Q]={children:((he=G.children[Q])==null?void 0:he.children)||{}},t(14,te=!1),t(10,se)}function F(b){const Q=b.detail.path,G=b.detail.action;if(G=="highlight"){t(15,m=Q),t(14,te=!1);return}else if(G=="de-highlight"){re&&t(15,m=[]);return}z(Q)}function c(){t(6,X=window.innerWidth),t(5,q=window.innerHeight)}function d(b){C=b,t(7,C)}function K(b){le=b,t(17,le)}function ue(b){pe=b,t(8,pe)}function Ie(){j=Mt(this),t(0,j),t(25,u)}function ke(b){U=b,t(18,U)}function be(b){ve=b,t(11,ve)}const H=()=>{t(14,te=!te)};return i.$$set=b=>{"defaultQcSpecId"in b&&t(29,v=b.defaultQcSpecId),"selectedQcRootId"in b&&t(30,S=b.selectedQcRootId),"rootType"in b&&t(31,B=b.rootType),"attributeLabels"in b&&t(2,ee=b.attributeLabels),"fullQcSpecs"in b&&t(28,A=b.fullQcSpecs),"removeHighlightUnhover"in b&&t(32,re=b.removeHighlightUnhover),"startSentence"in b&&t(3,D=b.startSentence),"specFilterYear"in b&&t(0,j=b.specFilterYear),"rootName"in b&&t(1,ne=b.rootName)},i.$$.update=()=>{i.$$.dirty[0]&1&&t(34,s=j==yi?"all":`y-${j}`),i.$$.dirty[0]&96&&t(12,r=q/X*Ke),i.$$.dirty[0]&4128&&t(36,l=b=>b*q/r),i.$$.dirty[0]&64&&t(35,n=b=>b*X/Ke),i.$$.dirty[1]&48&&t(23,a=Ti(l,n)),i.$$.dirty[0]&4096&&t(22,f=Ae*r/100),i.$$.dirty[0]&4096&&t(21,h={height:r*we/100,width:ft,x:fe+it,y:-r*we/100}),i.$$.dirty[0]&4096&&t(20,p={height:r,width:Ke,x:0,y:-(we+Ae)*r/100}),i.$$.dirty[0]&1073743876|i.$$.dirty[1]&9&&k(ve,S,B,ee,s),i.$$.dirty[0]&128&&ye(C),i.$$.dirty[0]&256&&E(pe),i.$$.dirty[0]&1556|i.$$.dirty[1]&4&&t(13,y=ei(me,Y,se,ee,w)),i.$$.dirty[0]&268449792|i.$$.dirty[1]&1&&I(y,r*(1-(we+ht)/100),M,je(A,B),ve)},t(24,o=ki),[j,ne,ee,D,w,q,X,C,pe,me,se,ve,r,y,te,m,T,le,U,W,p,h,f,a,o,u,fe,F,A,v,S,B,re,Y,s,n,l,c,d,K,ue,Ie,ke,be,H]}class Vi extends xe{constructor(e){super(),$e(this,e,Ii,vi,Ze,{defaultQcSpecId:29,selectedQcRootId:30,rootType:31,attributeLabels:2,fullQcSpecs:28,removeHighlightUnhover:32,startSentence:3,specFilterYear:0,rootName:1},null,[-1,-1,-1])}}export{Vi as F,Qi as f};
