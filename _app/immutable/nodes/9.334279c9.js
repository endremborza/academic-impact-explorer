import{I as Dt,s as je,e as Me,i as Q,d as b,D as x,a as ne,E as $,h as B,c as se,j as f,k as T,w as L,G as ve,J as Pe,H as ye,K as Bt,L as Nt,M as Qt,f as ee,g as te,A as He,C as Ve,l as Te,m as Ce,n as ze,p as qe,N as Ae,O as Ue,P as Xt,v as Wt,B as Ft,o as Gt,Q as st,R as Zt}from"../chunks/scheduler.1836b3fe.js";import{S as De,i as Ne,g as Se,c as Ee,a as A,t as J,b as de,d as ge,m as pe,f as ue,e as me,h as Qe}from"../chunks/index.7ef31ebf.js";import{e as ce,u as Ut,o as Yt}from"../chunks/each.11058b4e.js";import{p as Jt}from"../chunks/stores.ffd114b0.js";import{a as Kt,b as xt,S as $t,g as el}from"../chunks/SimpleAutocomplete.32ed35d4.js";import{b as tl}from"../chunks/paths.946fbb25.js";import{g as Je,h as rt,m as ll,d as il,a as nl,D as ot,b as sl}from"../chunks/tree-loading.c61db980.js";import{f as _e}from"../chunks/index.a3ef60df.js";import{B as lt,a as rl}from"../chunks/BrokenFittedText.79cd2eb3.js";import{P as ol}from"../chunks/PathLevelInfoBox.80112be8.js";function at(t){return function(){return t}}const Ke=Math.PI,xe=2*Ke,Re=1e-6,al=xe-Re;function zt(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}function fl(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return zt;const l=10**e;return function(i){this._+=i[0];for(let a=1,s=i.length;a<s;++a)this._+=Math.round(arguments[a]*l)/l+i[a]}}class hl{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?zt:fl(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,i,a){this._append`Q${+e},${+l},${this._x1=+i},${this._y1=+a}`}bezierCurveTo(e,l,i,a,s,n){this._append`C${+e},${+l},${+i},${+a},${this._x1=+s},${this._y1=+n}`}arcTo(e,l,i,a,s){if(e=+e,l=+l,i=+i,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let n=this._x1,o=this._y1,r=i-e,u=a-l,c=n-e,h=o-l,_=c*c+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=l}`;else if(_>Re)if(!(Math.abs(h*r-u*c)>Re)||!s)this._append`L${this._x1=e},${this._y1=l}`;else{let I=i-n,g=a-o,p=r*r+u*u,S=I*I+g*g,C=Math.sqrt(p),H=Math.sqrt(_),z=s*Math.tan((Ke-Math.acos((p+_-S)/(2*C*H)))/2),v=z/H,X=z/C;Math.abs(v-1)>Re&&this._append`L${e+v*c},${l+v*h}`,this._append`A${s},${s},0,0,${+(h*I>c*g)},${this._x1=e+X*r},${this._y1=l+X*u}`}}arc(e,l,i,a,s,n){if(e=+e,l=+l,i=+i,n=!!n,i<0)throw new Error(`negative radius: ${i}`);let o=i*Math.cos(a),r=i*Math.sin(a),u=e+o,c=l+r,h=1^n,_=n?a-s:s-a;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Re||Math.abs(this._y1-c)>Re)&&this._append`L${u},${c}`,i&&(_<0&&(_=_%xe+xe),_>al?this._append`A${i},${i},0,1,${h},${e-o},${l-r}A${i},${i},0,1,${h},${this._x1=u},${this._y1=c}`:_>Re&&this._append`A${i},${i},0,${+(_>=Ke)},${h},${this._x1=e+i*Math.cos(s)},${this._y1=l+i*Math.sin(s)}`)}rect(e,l,i,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${i=+i}v${+a}h${-i}Z`}toString(){return this._}}function ul(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(l==null)e=null;else{const i=Math.floor(l);if(!(i>=0))throw new RangeError(`invalid digits: ${l}`);e=i}return t},()=>new hl(e)}var cl=Array.prototype.slice;function _l(t){return t[0]}function dl(t){return t[1]}class gl{constructor(e,l){this._context=e,this._x=l}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,l){switch(e=+e,l=+l,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,l):this._context.moveTo(e,l);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,l,e,l):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+l)/2,e,this._y0,e,l);break}}this._x0=e,this._y0=l}}function pl(t){return new gl(t,!1)}function ml(t){return t.source}function bl(t){return t.target}function vl(t){let e=ml,l=bl,i=_l,a=dl,s=null,n=null,o=ul(r);function r(){let u;const c=cl.call(arguments),h=e.apply(this,c),_=l.apply(this,c);if(s==null&&(n=t(u=o())),n.lineStart(),c[0]=h,n.point(+i.apply(this,c),+a.apply(this,c)),c[0]=_,n.point(+i.apply(this,c),+a.apply(this,c)),n.lineEnd(),u)return n=null,u+""||null}return r.source=function(u){return arguments.length?(e=u,r):e},r.target=function(u){return arguments.length?(l=u,r):l},r.x=function(u){return arguments.length?(i=typeof u=="function"?u:at(+u),r):i},r.y=function(u){return arguments.length?(a=typeof u=="function"?u:at(+u),r):a},r.context=function(u){return arguments.length?(u==null?s=n=null:n=t(s=u),r):s},r}function wl(){return vl(pl)}function Pt(){return Dt()}function Le(t,e,l,i,a){return()=>{t("ti",{path:l,action:e,topLeftCorner:{x:i,y:a}})}}function ft(t,e){return()=>{t("ce",{ind:e})}}function ht(t,e,l){const i=t.slice();return i[44]=e[l].id,i[45]=e[l].cachedProps,i[46]=e[l].vizInfo,i[47]=e[l].childNode,i}function ut(t){let e,l;const i=[t[45],{qcSpec:t[0]},{attributeLabels:t[1]},{visibleTreeInfo:t[2]},{selectionState:t[3]},{levelVisuals:t[4]},{treeWidth:t[5]},{treeXOffset:t[9]},{childRate:t[6]},{overHangRate:t[7]},{preStraightRate:t[8]},{childBaseSize:t[10]},{linkSurfaceRate:t[11]},{childrenInternalMargin:t[12]},{parentSideMargin:0}];let a={};for(let s=0;s<i.length;s+=1)a=Qt(a,i[s]);return e=new Ht({props:a}),e.$on("ti",t[33]),{c(){de(e.$$.fragment)},l(s){ge(e.$$.fragment,s)},m(s,n){pe(e,s,n),l=!0},p(s,n){const o=n[0]&40959?Kt(i,[n[0]&32768&&xt(s[45]),n[0]&1&&{qcSpec:s[0]},n[0]&2&&{attributeLabels:s[1]},n[0]&4&&{visibleTreeInfo:s[2]},n[0]&8&&{selectionState:s[3]},n[0]&16&&{levelVisuals:s[4]},n[0]&32&&{treeWidth:s[5]},n[0]&512&&{treeXOffset:s[9]},n[0]&64&&{childRate:s[6]},n[0]&128&&{overHangRate:s[7]},n[0]&256&&{preStraightRate:s[8]},n[0]&1024&&{childBaseSize:s[10]},n[0]&2048&&{linkSurfaceRate:s[11]},n[0]&4096&&{childrenInternalMargin:s[12]},i[14]]):{};e.$set(o)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){J(e.$$.fragment,s),l=!1},d(s){me(e,s)}}}function ct(t,e){let l,i,a,s,n,o,r,u,c,h,_,I,g,p,S,C,H,z,v,X,Z,j,U,W,V,F,Y,R,E,G,q,P,ie,O,re,m;Y=new lt({props:{text:e[47].name,width:e[46].width*.8,height:e[13]}});let w=e[47].children&&ut(e);return{key:t,first:null,c(){l=x("defs"),i=x("linearGradient"),a=x("stop"),o=x("stop"),c=x("stop"),g=ne(),p=x("path"),z=ne(),v=x("rect"),V=ne(),F=x("g"),de(Y.$$.fragment),R=ne(),E=x("rect"),P=ne(),w&&w.c(),ie=Me(),this.h()},l(d){l=$(d,"defs",{});var k=B(l);i=$(k,"linearGradient",{id:!0,gradientTransform:!0});var le=B(i);a=$(le,"stop",{offset:!0,"stop-opacity":!0,"stop-color":!0,class:!0}),B(a).forEach(b),o=$(le,"stop",{offset:!0,"stop-opacity":!0,"stop-color":!0,class:!0}),B(o).forEach(b),c=$(le,"stop",{offset:!0,"stop-opacity":!0,"stop-color":!0,class:!0}),B(c).forEach(b),le.forEach(b),k.forEach(b),g=se(d),p=$(d,"path",{d:!0,fill:!0,class:!0}),B(p).forEach(b),z=se(d),v=$(d,"rect",{"fill-opacity":!0,x:!0,y:!0,height:!0,width:!0,class:!0}),B(v).forEach(b),V=se(d),F=$(d,"g",{style:!0});var ae=B(F);ge(Y.$$.fragment,ae),ae.forEach(b),R=se(d),E=$(d,"rect",{x:!0,y:!0,"fill-opacity":!0,height:!0,width:!0,class:!0}),B(E).forEach(b),P=se(d),w&&w.l(d),ie=Me(),this.h()},h(){f(a,"offset","0%"),f(a,"stop-opacity",s=e[47].isSelected?"80%":"5%"),f(a,"stop-color",n=e[46].colorStr),f(a,"class","svelte-1cwbp37"),f(o,"offset","20%"),f(o,"stop-opacity",r=e[47].isSelected?"80%":"15%"),f(o,"stop-color",u=e[46].colorStr),f(o,"class","svelte-1cwbp37"),f(c,"offset","50%"),f(c,"stop-opacity",h=e[47].isSelected?"80%":"25%"),f(c,"stop-color",_=e[46].colorStr),f(c,"class","svelte-1cwbp37"),f(i,"id",I="path-grad-"+e[46].strId),f(i,"gradientTransform","rotate(90)"),f(p,"d",S=e[46].linkPath),f(p,"fill",C="url('#path-grad-"+e[46].strId+"')"),f(p,"class","svelte-1cwbp37"),f(v,"fill-opacity",X=.25+Math.abs(e[47].specMetric.normalizedMetric)/1.5),f(v,"x",Z=e[45].xOffset),f(v,"y",j=e[14]+e[13]/2-(e[47].specMetric.normalizedMetric<0?0:e[47].specMetric.normalizedMetric*e[13]/2)),f(v,"height",U=Math.abs(e[47].specMetric.normalizedMetric)*e[13]/2),f(v,"width",W=e[5]/20),f(v,"class","svelte-1cwbp37"),T(F,"--y-off",e[16]+"px"),T(F,"--x-off",e[45].xOffset+e[46].width*.1+"px"),f(E,"x",G=e[45].xOffset),f(E,"y",e[14]),f(E,"fill-opacity","0"),f(E,"height",e[13]),f(E,"width",q=e[46].width),f(E,"class","svelte-1cwbp37"),this.first=l},m(d,k){Q(d,l,k),L(l,i),L(i,a),L(i,o),L(i,c),Q(d,g,k),Q(d,p,k),Q(d,z,k),Q(d,v,k),Q(d,V,k),Q(d,F,k),pe(Y,F,null),Q(d,R,k),Q(d,E,k),Q(d,P,k),w&&w.m(d,k),Q(d,ie,k),O=!0,re||(m=[ve(E,"mouseover",function(){Pe(Le(e[17],"highlight",e[45].pathInCompleteTree,e[45].xOffset+e[45].width/2,e[14]))&&Le(e[17],"highlight",e[45].pathInCompleteTree,e[45].xOffset+e[45].width/2,e[14]).apply(this,arguments)}),ve(E,"mouseleave",function(){Pe(Le(e[17],"de-highlight",e[45].pathInCompleteTree,0,0))&&Le(e[17],"de-highlight",e[45].pathInCompleteTree,0,0).apply(this,arguments)}),ve(E,"click",function(){Pe(Le(e[17],"toggle-select",e[45].pathInCompleteTree,0,0))&&Le(e[17],"toggle-select",e[45].pathInCompleteTree,0,0).apply(this,arguments)})],re=!0)},p(d,k){e=d,(!O||k[0]&32768&&s!==(s=e[47].isSelected?"80%":"5%"))&&f(a,"stop-opacity",s),(!O||k[0]&32768&&n!==(n=e[46].colorStr))&&f(a,"stop-color",n),(!O||k[0]&32768&&r!==(r=e[47].isSelected?"80%":"15%"))&&f(o,"stop-opacity",r),(!O||k[0]&32768&&u!==(u=e[46].colorStr))&&f(o,"stop-color",u),(!O||k[0]&32768&&h!==(h=e[47].isSelected?"80%":"25%"))&&f(c,"stop-opacity",h),(!O||k[0]&32768&&_!==(_=e[46].colorStr))&&f(c,"stop-color",_),(!O||k[0]&32768&&I!==(I="path-grad-"+e[46].strId))&&f(i,"id",I),(!O||k[0]&32768&&S!==(S=e[46].linkPath))&&f(p,"d",S),(!O||k[0]&32768&&C!==(C="url('#path-grad-"+e[46].strId+"')"))&&f(p,"fill",C),(!O||k[0]&32768&&X!==(X=.25+Math.abs(e[47].specMetric.normalizedMetric)/1.5))&&f(v,"fill-opacity",X),(!O||k[0]&32768&&Z!==(Z=e[45].xOffset))&&f(v,"x",Z),(!O||k[0]&57344&&j!==(j=e[14]+e[13]/2-(e[47].specMetric.normalizedMetric<0?0:e[47].specMetric.normalizedMetric*e[13]/2)))&&f(v,"y",j),(!O||k[0]&40960&&U!==(U=Math.abs(e[47].specMetric.normalizedMetric)*e[13]/2))&&f(v,"height",U),(!O||k[0]&32&&W!==(W=e[5]/20))&&f(v,"width",W);const le={};k[0]&32768&&(le.text=e[47].name),k[0]&32768&&(le.width=e[46].width*.8),k[0]&8192&&(le.height=e[13]),Y.$set(le),(!O||k[0]&65536)&&T(F,"--y-off",e[16]+"px"),(!O||k[0]&32768)&&T(F,"--x-off",e[45].xOffset+e[46].width*.1+"px"),(!O||k[0]&32768&&G!==(G=e[45].xOffset))&&f(E,"x",G),(!O||k[0]&16384)&&f(E,"y",e[14]),(!O||k[0]&8192)&&f(E,"height",e[13]),(!O||k[0]&32768&&q!==(q=e[46].width))&&f(E,"width",q),e[47].children?w?(w.p(e,k),k[0]&32768&&A(w,1)):(w=ut(e),w.c(),A(w,1),w.m(ie.parentNode,ie)):w&&(Se(),J(w,1,1,()=>{w=null}),Ee())},i(d){O||(d&&ye(()=>{O&&(H||(H=ue(p,_e,{duration:300},!0)),H.run(1))}),A(Y.$$.fragment,d),A(w),O=!0)},o(d){d&&(H||(H=ue(p,_e,{duration:300},!1)),H.run(0)),J(Y.$$.fragment,d),J(w),O=!1},d(d){d&&(b(l),b(g),b(p),b(z),b(v),b(V),b(F),b(R),b(E),b(P),b(ie)),d&&H&&H.end(),me(Y),w&&w.d(d),re=!1,Bt(m)}}}function kl(t){let e=[],l=new Map,i,a,s=ce(t[15]);const n=o=>o[44];for(let o=0;o<s.length;o+=1){let r=ht(t,s,o),u=n(r);l.set(u,e[o]=ct(u,r))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();i=Me()},l(o){for(let r=0;r<e.length;r+=1)e[r].l(o);i=Me()},m(o,r){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(o,r);Q(o,i,r),a=!0},p(o,r){r[0]&262143&&(s=ce(o[15]),Se(),e=Ut(e,r,n,1,o,s,l,i.parentNode,Yt,ct,i,ht),Ee())},i(o){if(!a){for(let r=0;r<s.length;r+=1)A(e[r]);a=!0}},o(o){for(let r=0;r<e.length;r+=1)J(e[r]);a=!1},d(o){o&&b(i);for(let r=0;r<e.length;r+=1)e[r].d(o)}}}function _t(t,e,l,i,a,s,n){const o=c=>a*(c||0)/s,r=i+o(e),u=t+((l==null?void 0:l.rank)||0)*(i+n)+o(l==null?void 0:l.weight);return{width:r,xOffset:u}}function Sl(t,e,l){let i,a,s,n,o,r,u,c,h,_,I,g,p,S,C,H,z,v,{qcSpec:X}=e,{attributeLabels:Z}=e,{visibleTreeInfo:j}=e,{selectionState:U}=e,{levelVisuals:W=[]}=e,{pathInCompleteTree:V=[]}=e,{branchReachBack:F=0}=e,{rootWidth:Y=30}=e,{treeWidth:R=70}=e,{childRate:E=.2}=e,{overHangRate:G=.05}=e,{preStraightRate:q=.05}=e,{treeXOffset:P=0}=e,{childBaseSize:ie=2.9}=e,{linkSurfaceRate:O=.8}=e,{childrenInternalMargin:re=.9}=e,{parentSideMargin:m=.8}=e,{width:w=Y}=e,{xOffset:d=(R-Y)/2+P}=e;const k=Pt(),le=wl().source(M=>M.start).target(M=>M.end),ae=M=>M===void 0?0:M;function D(M,oe){var nt;const Oe={pathInCompleteTree:[...V,M],..._t(P,oe.weight,oe==null?void 0:oe.totalOffsetOnLevel,ie,z,((nt=j.meta[a])==null?void 0:nt.totalWeight)||1,re)},y=_t(d+m,oe.weight,oe==null?void 0:oe.totalOffsetAmongSiblings,H,S*(n>1?O:1)-H*n,(s==null?void 0:s.childrenSumWeight)||1,C),N={parent:y.width,child:Oe.width},K={start:[y.xOffset,p],end:[Oe.xOffset,I]},we={start:[K.end[0]+N.child,I],end:[K.start[0]+N.parent,p]},he=c+(oe.isSelected?_:0),jt=`${le(K)} v ${he} h ${N.child}`,qt=`v ${-he} ${le(we)} v ${-h-F} h ${-N.parent}`,At=jt+qt+` v ${h+F}`;return{id:M,cachedProps:Oe,vizInfo:{linkPath:At,width:N.child,colorStr:rl(oe.scaleEnds.mid),strId:Oe.pathInCompleteTree.join("-")},childNode:oe}}function fe(M,oe){return Object.entries((M==null?void 0:M.children)||{}).map(([Oe,y])=>D(Oe,y))}function be(M){Nt.call(this,t,M)}return t.$$set=M=>{"qcSpec"in M&&l(0,X=M.qcSpec),"attributeLabels"in M&&l(1,Z=M.attributeLabels),"visibleTreeInfo"in M&&l(2,j=M.visibleTreeInfo),"selectionState"in M&&l(3,U=M.selectionState),"levelVisuals"in M&&l(4,W=M.levelVisuals),"pathInCompleteTree"in M&&l(18,V=M.pathInCompleteTree),"branchReachBack"in M&&l(19,F=M.branchReachBack),"rootWidth"in M&&l(20,Y=M.rootWidth),"treeWidth"in M&&l(5,R=M.treeWidth),"childRate"in M&&l(6,E=M.childRate),"overHangRate"in M&&l(7,G=M.overHangRate),"preStraightRate"in M&&l(8,q=M.preStraightRate),"treeXOffset"in M&&l(9,P=M.treeXOffset),"childBaseSize"in M&&l(10,ie=M.childBaseSize),"linkSurfaceRate"in M&&l(11,O=M.linkSurfaceRate),"childrenInternalMargin"in M&&l(12,re=M.childrenInternalMargin),"parentSideMargin"in M&&l(21,m=M.parentSideMargin),"width"in M&&l(22,w=M.width),"xOffset"in M&&l(23,d=M.xOffset)},t.$$.update=()=>{var M;t.$$.dirty[0]&262144&&l(32,i=V.length),t.$$.dirty[1]&2&&l(29,a=i+1),t.$$.dirty[0]&262148&&l(25,s=Je(V,j.tree)),t.$$.dirty[0]&33554432&&l(27,n=Object.keys((s==null?void 0:s.children)||{}).length),t.$$.dirty[0]&16|t.$$.dirty[1]&2&&l(24,o=W[i]),t.$$.dirty[0]&4|t.$$.dirty[1]&2&&j.meta[i].totalNodes,t.$$.dirty[0]&536870916&&l(30,r=((M=j.meta[a])==null?void 0:M.totalNodes)||0),t.$$.dirty[0]&16777664&&l(31,[u,c,h,_]=[o==null?void 0:o.topOffset,...[E,q,G].map(oe=>(o==null?void 0:o.totalSize)*oe)].map(ae),u,(l(13,c),l(24,o),l(6,E),l(8,q),l(7,G),l(4,W),l(32,i),l(18,V)),(l(26,h),l(24,o),l(6,E),l(8,q),l(7,G),l(4,W),l(32,i),l(18,V))),t.$$.dirty[0]&16777536|t.$$.dirty[1]&1&&l(14,I=u+ae((o==null?void 0:o.totalSize)*(1-E-q))),t.$$.dirty[0]&24576&&l(16,g=I+c),t.$$.dirty[0]&67108864|t.$$.dirty[1]&1&&(p=u+h),t.$$.dirty[0]&6291456&&l(28,S=w-2*m),t.$$.dirty[0]&402655232&&(C=S*(1-O)/(n>1?n-1:1)),t.$$.dirty[0]&402655232&&(H=S*O/(n*1.8)),t.$$.dirty[0]&1073746976&&(z=R-ie*r-re*(r-1)),t.$$.dirty[0]&50331648&&l(15,v=fe(s))},[X,Z,j,U,W,R,E,G,q,P,ie,O,re,c,I,v,g,k,V,F,Y,m,w,d,o,s,h,n,S,a,r,u,i,be]}class Ht extends De{constructor(e){super(),Ne(this,e,Sl,kl,je,{qcSpec:0,attributeLabels:1,visibleTreeInfo:2,selectionState:3,levelVisuals:4,pathInCompleteTree:18,branchReachBack:19,rootWidth:20,treeWidth:5,childRate:6,overHangRate:7,preStraightRate:8,treeXOffset:9,childBaseSize:10,linkSurfaceRate:11,childrenInternalMargin:12,parentSideMargin:21,width:22,xOffset:23},null,[-1,-1])}}function dt(t,e,l){const i=t.slice();return i[11]=e[l],i}function gt(t){let e,l=t[11]+"",i,a;return{c(){e=ee("div"),i=Te(l),a=ne(),this.h()},l(s){e=te(s,"DIV",{class:!0});var n=B(e);i=Ce(n,l),n.forEach(b),a=se(s),this.h()},h(){f(e,"class","svelte-6fgk1b")},m(s,n){Q(s,e,n),L(e,i),Q(s,a,n)},p(s,n){n&1&&l!==(l=s[11]+"")&&ze(i,l)},d(s){s&&(b(e),b(a))}}}function El(t){let e,l,i,a,s,n,o=ce(t[0]),r=[];for(let u=0;u<o.length;u+=1)r[u]=gt(dt(t,o,u));return{c(){e=ee("label"),l=ee("input"),i=ne(),a=ee("span");for(let u=0;u<r.length;u+=1)r[u].c();this.h()},l(u){e=te(u,"LABEL",{class:!0,style:!0});var c=B(e);l=te(c,"INPUT",{type:!0,class:!0}),i=se(c),a=te(c,"SPAN",{class:!0});var h=B(a);for(let _=0;_<r.length;_+=1)r[_].l(h);h.forEach(b),c.forEach(b),this.h()},h(){f(l,"type","checkbox"),f(l,"class","svelte-6fgk1b"),f(a,"class","slider round svelte-6fgk1b"),f(e,"class","switch svelte-6fgk1b"),T(e,"--pad",t[1]+"px"),T(e,"--fw",t[4]+"px"),T(e,"--w",t[4]/2+"px"),T(e,"--tw",t[4]/2-2*t[1]+"px"),T(e,"--height",t[2]+"px"),T(e,"--full-height",t[2]+2*t[1]+"px"),T(e,"--label","'"+t[5]+"'")},m(u,c){Q(u,e,c),L(e,l),l.checked=t[3],L(e,i),L(e,a);for(let h=0;h<r.length;h+=1)r[h]&&r[h].m(a,null);s||(n=ve(l,"change",t[9]),s=!0)},p(u,[c]){if(c&8&&(l.checked=u[3]),c&1){o=ce(u[0]);let h;for(h=0;h<o.length;h+=1){const _=dt(u,o,h);r[h]?r[h].p(_,c):(r[h]=gt(_),r[h].c(),r[h].m(a,null))}for(;h<r.length;h+=1)r[h].d(1);r.length=o.length}c&2&&T(e,"--pad",u[1]+"px"),c&16&&T(e,"--fw",u[4]+"px"),c&16&&T(e,"--w",u[4]/2+"px"),c&18&&T(e,"--tw",u[4]/2-2*u[1]+"px"),c&4&&T(e,"--height",u[2]+"px"),c&6&&T(e,"--full-height",u[2]+2*u[1]+"px"),c&32&&T(e,"--label","'"+u[5]+"'")},i:He,o:He,d(u){u&&b(e),Ve(r,u),s=!1,n()}}}function Ol(t){return((t[0].length>t[1].length?t[0].length:t[1].length)*.8+2)*20}function Il(t,e,l){let i,a,{values:s=["On","Off"]}=e,{labels:n=s}=e,{value:o=s[0]}=e,{pad:r=5}=e,{height:u=26}=e,{width:c=void 0}=e,h=o==s[1];const _=g=>{l(6,o=g?s[1]:s[0])};function I(){h=this.checked,l(3,h)}return t.$$set=g=>{"values"in g&&l(7,s=g.values),"labels"in g&&l(0,n=g.labels),"value"in g&&l(6,o=g.value),"pad"in g&&l(1,r=g.pad),"height"in g&&l(2,u=g.height),"width"in g&&l(8,c=g.width)},t.$$.update=()=>{t.$$.dirty&9&&l(5,i=h?n[1]:n[0]),t.$$.dirty&8&&_(h),t.$$.dirty&257&&l(4,a=c||Ol(n))},[n,r,u,h,a,i,o,s,c,I]}class it extends De{constructor(e){super(),Ne(this,e,Il,El,je,{values:7,labels:0,value:6,pad:1,height:2,width:8})}}function Ml(t){let e,l,i,a,s,n,o,r,u,c;return{c(){e=x("path"),i=ne(),a=x("path"),n=ne(),o=x("g"),r=x("path"),this.h()},l(h){e=$(h,"path",{d:!0,fill:!0,"fill-opacity":!0,class:!0}),B(e).forEach(b),i=se(h),a=$(h,"path",{d:!0,fill:!0,class:!0}),B(a).forEach(b),n=se(h),o=$(h,"g",{style:!0,class:!0});var _=B(o);r=$(_,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,fill:!0,class:!0}),B(r).forEach(b),_.forEach(b),this.h()},h(){f(e,"d",l="M0 0 H"+t[0]+" V"+t[0]+" H0 V0 Z"),f(e,"fill","var(--color-theme-blue)"),f(e,"fill-opacity","0.7"),f(e,"class","svelte-12wtsp1"),f(a,"d",s="M0 "+t[2]+" H"+t[0]+" V0 H0 V0 Z"),f(a,"fill","var(--color-theme-lightblue)"),f(a,"class","svelte-12wtsp1"),f(r,"d",u="M"+t[0]*Xe+" "+t[3]+" L"+t[0]*.5+" "+t[0]*Fe+" L"+t[0]*(1-Xe)+" "+t[3]),f(r,"stroke","var(--color-theme-white)"),f(r,"stroke-width",c=pt*t[0]),f(r,"stroke-linecap","round"),f(r,"stroke-linejoin","round"),f(r,"fill","none"),f(r,"class","svelte-12wtsp1"),T(o,"--rot",t[1]+"deg"),T(o,"--rx",t[0]/2+"px"),T(o,"--ry",t[0]*($e+Fe)/2+"px"),f(o,"class","svelte-12wtsp1")},m(h,_){Q(h,e,_),Q(h,i,_),Q(h,a,_),Q(h,n,_),Q(h,o,_),L(o,r)},p(h,[_]){_&1&&l!==(l="M0 0 H"+h[0]+" V"+h[0]+" H0 V0 Z")&&f(e,"d",l),_&5&&s!==(s="M0 "+h[2]+" H"+h[0]+" V0 H0 V0 Z")&&f(a,"d",s),_&9&&u!==(u="M"+h[0]*Xe+" "+h[3]+" L"+h[0]*.5+" "+h[0]*Fe+" L"+h[0]*(1-Xe)+" "+h[3])&&f(r,"d",u),_&1&&c!==(c=pt*h[0])&&f(r,"stroke-width",c),_&2&&T(o,"--rot",h[1]+"deg"),_&1&&T(o,"--rx",h[0]/2+"px"),_&1&&T(o,"--ry",h[0]*($e+Fe)/2+"px")},i:He,o:He,d(h){h&&(b(e),b(i),b(a),b(n),b(o))}}}let yl=.13,Xe=.15,Fe=.78,$e=.34,pt=.08;function Rl(t,e,l){let i,a,{size:s=3}=e,{rotated:n=0}=e,{text:o="expand"}=e;return t.$$set=r=>{"size"in r&&l(0,s=r.size),"rotated"in r&&l(1,n=r.rotated),"text"in r&&l(4,o=r.text)},t.$$.update=()=>{t.$$.dirty&1&&l(3,i=s*$e),t.$$.dirty&1&&l(2,a=s*yl)},[s,n,a,i,o]}class Tl extends De{constructor(e){super(),Ne(this,e,Rl,Ml,je,{size:0,rotated:1,text:4})}}function mt(t,e,l){const i=t.slice();return i[36]=e[l],i[37]=e,i[38]=l,i}function bt(t,e,l){const i=t.slice();return i[39]=e[l],i}function vt(t){var F,Y;let e,l,i,a,s,n,o,r,u,c,h,_,I,g,p,S,C,H,z,v,X,Z;n=new lt({props:{text:((Y=(F=t[4])==null?void 0:F.bifurcations[t[1]])==null?void 0:Y.description)||"",width:t[2]*.9,height:t[10]*2}}),r=new Tl({props:{size:t[10],text:t[18]?"collapse":"expand",rotated:t[18]?180:0}});function j(R){t[32](R)}let U={values:t[22],width:t[19]};t[0][t[1]].size_base!==void 0&&(U.value=t[0][t[1]].size_base),I=new it({props:U}),qe.push(()=>Qe(I,"value",j));let W=t[14]>2.8&&wt(t),V=t[18]&&kt(t);return{c(){e=x("g"),l=x("rect"),s=x("g"),de(n.$$.fragment),o=x("g"),de(r.$$.fragment),u=x("g"),c=x("foreignObject"),h=ee("div"),_=ee("div"),de(I.$$.fragment),p=ne(),W&&W.c(),S=ne(),V&&V.c(),this.h()},l(R){e=$(R,"g",{style:!0});var E=B(e);l=$(E,"rect",{fill:!0,"fill-opacity":!0,x:!0,height:!0,width:!0,class:!0}),B(l).forEach(b),s=$(E,"g",{style:!0});var G=B(s);ge(n.$$.fragment,G),G.forEach(b),o=$(E,"g",{style:!0});var q=B(o);ge(r.$$.fragment,q),q.forEach(b),u=$(E,"g",{style:!0});var P=B(u);c=$(P,"foreignObject",{width:!0,height:!0,transform:!0});var ie=B(c);h=te(ie,"DIV",{class:!0,style:!0});var O=B(h);_=te(O,"DIV",{id:!0,class:!0});var re=B(_);ge(I.$$.fragment,re),re.forEach(b),p=se(O),W&&W.l(O),S=se(O),V&&V.l(O),O.forEach(b),ie.forEach(b),P.forEach(b),E.forEach(b),this.h()},h(){f(l,"fill","grey"),f(l,"fill-opacity",i=t[18]?.5:.3),f(l,"x",a=-t[16]),f(l,"height",t[11]),f(l,"width",t[3]),f(l,"class","svelte-o245wa"),T(s,"--x-off",t[2]*.1+"px"),T(s,"--y-off",-.5+"px"),T(o,"--x-off",t[2]*.85+"px"),T(o,"--y-off",t[15]+"px"),f(_,"id","spec-checkbox"),f(_,"class","svelte-o245wa"),f(h,"class","main-controls svelte-o245wa"),T(h,"--full-width",t[7]+"px"),T(h,"--slider-width",t[19]+"px"),T(h,"--label-width",Ye+"px"),T(h,"--thumb-width",tt+"px"),T(h,"--slider-height",et+"px"),T(h,"--thumb-height",t[20]+"px"),f(c,"width",t[7]),f(c,"height",C=t[11]/t[12]*1.5),f(c,"transform",H="scale("+t[12]+","+t[12]+")"),T(u,"--y-off",t[15]+"px"),T(e,"--y-off",t[17]+"px"),T(e,"--x-off",t[16]+"px")},m(R,E){Q(R,e,E),L(e,l),L(e,s),pe(n,s,null),L(e,o),pe(r,o,null),L(e,u),L(u,c),L(c,h),L(h,_),pe(I,_,null),L(h,p),W&&W.m(h,null),L(h,S),V&&V.m(h,null),v=!0,X||(Z=ve(o,"click",function(){Pe(ft(t[21],t[1]))&&ft(t[21],t[1]).apply(this,arguments)}),X=!0)},p(R,E){var ie,O;t=R,(!v||E[0]&262144&&i!==(i=t[18]?.5:.3))&&f(l,"fill-opacity",i),(!v||E[0]&65536&&a!==(a=-t[16]))&&f(l,"x",a),(!v||E[0]&2048)&&f(l,"height",t[11]),(!v||E[0]&8)&&f(l,"width",t[3]);const G={};E[0]&18&&(G.text=((O=(ie=t[4])==null?void 0:ie.bifurcations[t[1]])==null?void 0:O.description)||""),E[0]&4&&(G.width=t[2]*.9),E[0]&1024&&(G.height=t[10]*2),n.$set(G),(!v||E[0]&4)&&T(s,"--x-off",t[2]*.1+"px");const q={};E[0]&1024&&(q.size=t[10]),E[0]&262144&&(q.text=t[18]?"collapse":"expand"),E[0]&262144&&(q.rotated=t[18]?180:0),r.$set(q),(!v||E[0]&4)&&T(o,"--x-off",t[2]*.85+"px"),(!v||E[0]&32768)&&T(o,"--y-off",t[15]+"px");const P={};E[0]&524288&&(P.width=t[19]),!g&&E[0]&3&&(g=!0,P.value=t[0][t[1]].size_base,Ae(()=>g=!1)),I.$set(P),t[14]>2.8?W?(W.p(t,E),E[0]&16384&&A(W,1)):(W=wt(t),W.c(),A(W,1),W.m(h,S)):W&&(Se(),J(W,1,1,()=>{W=null}),Ee()),t[18]?V?(V.p(t,E),E[0]&262144&&A(V,1)):(V=kt(t),V.c(),A(V,1),V.m(h,null)):V&&(Se(),J(V,1,1,()=>{V=null}),Ee()),(!v||E[0]&128)&&T(h,"--full-width",t[7]+"px"),(!v||E[0]&524288)&&T(h,"--slider-width",t[19]+"px"),(!v||E[0]&128)&&f(c,"width",t[7]),(!v||E[0]&6144&&C!==(C=t[11]/t[12]*1.5))&&f(c,"height",C),(!v||E[0]&4096&&H!==(H="scale("+t[12]+","+t[12]+")"))&&f(c,"transform",H),(!v||E[0]&32768)&&T(u,"--y-off",t[15]+"px"),(!v||E[0]&131072)&&T(e,"--y-off",t[17]+"px"),(!v||E[0]&65536)&&T(e,"--x-off",t[16]+"px")},i(R){v||(A(n.$$.fragment,R),A(r.$$.fragment,R),A(I.$$.fragment,R),A(W),A(V),R&&ye(()=>{v&&(z||(z=ue(e,_e,{duration:1e3},!0)),z.run(1))}),v=!0)},o(R){J(n.$$.fragment,R),J(r.$$.fragment,R),J(I.$$.fragment,R),J(W),J(V),R&&(z||(z=ue(e,_e,{duration:1e3},!1)),z.run(0)),v=!1},d(R){R&&b(e),me(n),me(r),me(I),W&&W.d(),V&&V.d(),R&&z&&z.end(),X=!1,Z()}}}function wt(t){let e,l,i,a,s,n,o,r,u,c,h,_,I=t[0][t[1]].limit_n+"",g,p,S,C,H;return{c(){e=ee("div"),l=ee("div"),i=ee("span"),a=Te(t[6]),s=ne(),n=ee("input"),o=ne(),r=ee("span"),u=Te(t[5]),c=ne(),h=ee("label"),_=Te("show "),g=Te(I),this.h()},l(z){e=te(z,"DIV",{id:!0,style:!0,class:!0});var v=B(e);l=te(v,"DIV",{id:!0,class:!0});var X=B(l);i=te(X,"SPAN",{class:!0});var Z=B(i);a=Ce(Z,t[6]),Z.forEach(b),s=se(X),n=te(X,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),o=se(X),r=te(X,"SPAN",{class:!0});var j=B(r);u=Ce(j,t[5]),j.forEach(b),X.forEach(b),c=se(v),h=te(v,"LABEL",{for:!0,class:!0});var U=B(h);_=Ce(U,"show "),g=Ce(U,I),U.forEach(b),v.forEach(b),this.h()},h(){f(i,"class","svelte-o245wa"),f(n,"id","topn-input"),f(n,"type","range"),f(n,"min",t[6]),f(n,"max",t[5]),f(n,"class","svelte-o245wa"),f(r,"class","svelte-o245wa"),f(l,"id","topn-slider"),f(l,"class","svelte-o245wa"),f(h,"for","topn-input"),f(h,"class","svelte-o245wa"),f(e,"id","topn-control"),T(e,"--r",Ye+(t[19]-tt)*(t[0][t[1]].limit_n-t[6])/(t[5]-t[6])+"px"),f(e,"class","svelte-o245wa")},m(z,v){Q(z,e,v),L(e,l),L(l,i),L(i,a),L(l,s),L(l,n),Ue(n,t[0][t[1]].limit_n),L(l,o),L(l,r),L(r,u),L(e,c),L(e,h),L(h,_),L(h,g),S=!0,C||(H=[ve(n,"change",t[33]),ve(n,"input",t[33])],C=!0)},p(z,v){t=z,(!S||v[0]&64)&&ze(a,t[6]),(!S||v[0]&64)&&f(n,"min",t[6]),(!S||v[0]&32)&&f(n,"max",t[5]),v[0]&3&&Ue(n,t[0][t[1]].limit_n),(!S||v[0]&32)&&ze(u,t[5]),(!S||v[0]&3)&&I!==(I=t[0][t[1]].limit_n+"")&&ze(g,I),(!S||v[0]&524387)&&T(e,"--r",Ye+(t[19]-tt)*(t[0][t[1]].limit_n-t[6])/(t[5]-t[6])+"px")},i(z){S||(z&&ye(()=>{S&&(p||(p=ue(e,_e,{duration:Be},!0)),p.run(1))}),S=!0)},o(z){z&&(p||(p=ue(e,_e,{duration:Be},!1)),p.run(0)),S=!1},d(z){z&&b(e),z&&p&&p.end(),C=!1,Bt(H)}}}function kt(t){let e,l,i,a,s,n,o,r;function u(g){t[34](g)}let c={values:t[23],width:t[19]};t[8]!==void 0&&(c.value=t[8]),l=new it({props:c}),qe.push(()=>Qe(l,"value",u));let h=ce(["include","exclude"]),_=[];for(let g=0;g<2;g+=1)_[g]=Et(mt(t,h,g));const I=g=>J(_[g],1,1,()=>{_[g]=null});return{c(){e=ee("div"),de(l.$$.fragment),s=ne(),n=ee("div");for(let g=0;g<2;g+=1)_[g].c();this.h()},l(g){e=te(g,"DIV",{id:!0,class:!0});var p=B(e);ge(l.$$.fragment,p),p.forEach(b),s=se(g),n=te(g,"DIV",{class:!0});var S=B(n);for(let C=0;C<2;C+=1)_[C].l(S);S.forEach(b),this.h()},h(){f(e,"id","side-checkbox"),f(e,"class","svelte-o245wa"),f(n,"class","sub-controls")},m(g,p){Q(g,e,p),pe(l,e,null),Q(g,s,p),Q(g,n,p);for(let S=0;S<2;S+=1)_[S]&&_[S].m(n,null);r=!0},p(g,p){t=g;const S={};if(p[0]&524288&&(S.width=t[19]),!i&&p[0]&256&&(i=!0,S.value=t[8],Ae(()=>i=!1)),l.$set(S),p[0]&50339843){h=ce(["include","exclude"]);let C;for(C=0;C<2;C+=1){const H=mt(t,h,C);_[C]?(_[C].p(H,p),A(_[C],1)):(_[C]=Et(H),_[C].c(),A(_[C],1),_[C].m(n,null))}for(Se(),C=2;C<2;C+=1)I(C);Ee()}},i(g){if(!r){A(l.$$.fragment,g),g&&ye(()=>{r&&(a||(a=ue(e,_e,{duration:Be},!0)),a.run(1))});for(let p=0;p<2;p+=1)A(_[p]);g&&ye(()=>{r&&(o||(o=ue(n,_e,{duration:Be},!0)),o.run(1))}),r=!0}},o(g){J(l.$$.fragment,g),g&&(a||(a=ue(e,_e,{duration:Be},!1)),a.run(0)),_=_.filter(Boolean);for(let p=0;p<2;p+=1)J(_[p]);g&&(o||(o=ue(n,_e,{duration:Be},!1)),o.run(0)),r=!1},d(g){g&&(b(e),b(s),b(n)),me(l),g&&a&&a.end(),Ve(_,g),g&&o&&o.end()}}}function Cl(t){let e;return{c(){e=ee("span"),this.h()},l(l){e=te(l,"SPAN",{slot:!0}),B(e).forEach(b),this.h()},h(){f(e,"slot","tag")},m(l,i){Q(l,e,i)},p:He,d(l){l&&b(e)}}}function St(t){let e,l=t[25](t[39])+"",i,a,s,n="✖",o,r;return{c(){e=ee("span"),i=Te(l),a=ne(),s=ee("span"),s.textContent=n,this.h()},l(u){e=te(u,"SPAN",{class:!0});var c=B(e);i=Ce(c,l),a=se(c),s=te(c,"SPAN",{class:!0,"data-svelte-h":!0}),Wt(s)!=="svelte-1se0onn"&&(s.textContent=n),c.forEach(b),this.h()},h(){f(s,"class","clear-button svelte-o245wa"),f(e,"class","selected-card svelte-o245wa")},m(u,c){Q(u,e,c),L(e,i),L(e,a),L(e,s),o||(r=ve(s,"click",function(){Pe(t[24](t[39],t[36]))&&t[24](t[39],t[36]).apply(this,arguments)}),o=!0)},p(u,c){t=u,c[0]&3&&l!==(l=t[25](t[39])+"")&&ze(i,l)},d(u){u&&b(e),o=!1,r()}}}function Et(t){let e,l,i,a,s,n,o;function r(_){t[35](_,t[36])}let u={items:t[13],className:"sub-input-selector",inputClassName:"sub-input-box",multiple:!0,hideArrow:!0,labelFunction:t[25],maxItemsToShowInList:5,placeholder:t[36],$$slots:{tag:[Cl]},$$scope:{ctx:t}};t[0][t[1]][t[36]]!==void 0&&(u.value=t[0][t[1]][t[36]]),l=new $t({props:u}),qe.push(()=>Qe(l,"value",r));let c=ce(t[0][t[1]][t[36]]),h=[];for(let _=0;_<c.length;_+=1)h[_]=St(bt(t,c,_));return{c(){e=ee("div"),de(l.$$.fragment),a=ne(),s=ee("div");for(let _=0;_<h.length;_+=1)h[_].c();n=ne(),this.h()},l(_){e=te(_,"DIV",{class:!0});var I=B(e);ge(l.$$.fragment,I),I.forEach(b),a=se(_),s=te(_,"DIV",{class:!0});var g=B(s);for(let p=0;p<h.length;p+=1)h[p].l(g);n=se(g),g.forEach(b),this.h()},h(){f(e,"class","sub-input svelte-o245wa"),f(s,"class","card-set svelte-o245wa")},m(_,I){Q(_,e,I),pe(l,e,null),Q(_,a,I),Q(_,s,I);for(let g=0;g<h.length;g+=1)h[g]&&h[g].m(s,null);L(s,n),o=!0},p(_,I){t=_;const g={};if(I[0]&8192&&(g.items=t[13]),I[1]&2048&&(g.$$scope={dirty:I,ctx:t}),!i&&I[0]&3&&(i=!0,g.value=t[0][t[1]][t[36]],Ae(()=>i=!1)),l.$set(g),I[0]&50331651){c=ce(t[0][t[1]][t[36]]);let p;for(p=0;p<c.length;p+=1){const S=bt(t,c,p);h[p]?h[p].p(S,I):(h[p]=St(S),h[p].c(),h[p].m(s,n))}for(;p<h.length;p+=1)h[p].d(1);h.length=c.length}},i(_){o||(A(l.$$.fragment,_),o=!0)},o(_){J(l.$$.fragment,_),o=!1},d(_){_&&(b(e),b(a),b(s)),me(l),Ve(h,_)}}}function Ll(t){let e,l,i=t[9]!=null&&vt(t);return{c(){i&&i.c(),e=Me()},l(a){i&&i.l(a),e=Me()},m(a,s){i&&i.m(a,s),Q(a,e,s),l=!0},p(a,s){a[9]!=null?i?(i.p(a,s),s[0]&512&&A(i,1)):(i=vt(a),i.c(),A(i,1),i.m(e.parentNode,e)):i&&(Se(),J(i,1,1,()=>{i=null}),Ee())},i(a){l||(A(i),l=!0)},o(a){J(i),l=!1},d(a){a&&b(e),i&&i.d(a)}}}let Be=200,Ye=30,et=30,tt=80;function Bl(t,e,l){let i,a,s,n,o,r,u,c,h,_,I,g,{lVis:p}=e,{index:S}=e,{expandedIndex:C}=e,{childRate:H}=e,{overHangRate:z}=e,{sideBarWidth:v}=e,{svgWidth:X}=e,{currentQcSpec:Z}=e,{controlSpecs:j}=e,{attributeLabels:U}=e,{maxOnOneLevel:W=15}=e,{minShow:V=1}=e,{controlHtmlWidth:F=320}=e,Y=et-4;const R=Pt();let E=["volume","specialization"],G=["highest","lowest"],q=j[S].show_top?"highest":"lowest";function P(d,k){return()=>{l(0,j[S][k]=j[S][k].filter(le=>le!=d),j)}}function ie(d){var k;return((k=I[d])==null?void 0:k.name)||"Unknown"}function O(d){t.$$.not_equal(j[S].size_base,d)&&(j[S].size_base=d,l(0,j),l(1,S),l(8,q))}function re(){j[S].limit_n=Xt(this.value),l(0,j),l(1,S),l(8,q)}function m(d){q=d,l(8,q)}function w(d,k){t.$$.not_equal(j[S][k],d)&&(j[S][k]=d,l(0,j),l(1,S),l(8,q))}return t.$$set=d=>{"lVis"in d&&l(26,p=d.lVis),"index"in d&&l(1,S=d.index),"expandedIndex"in d&&l(27,C=d.expandedIndex),"childRate"in d&&l(28,H=d.childRate),"overHangRate"in d&&l(29,z=d.overHangRate),"sideBarWidth"in d&&l(2,v=d.sideBarWidth),"svgWidth"in d&&l(3,X=d.svgWidth),"currentQcSpec"in d&&l(4,Z=d.currentQcSpec),"controlSpecs"in d&&l(0,j=d.controlSpecs),"attributeLabels"in d&&l(30,U=d.attributeLabels),"maxOnOneLevel"in d&&l(5,W=d.maxOnOneLevel),"minShow"in d&&l(6,V=d.minShow),"controlHtmlWidth"in d&&l(7,F=d.controlHtmlWidth)},t.$$.update=()=>{t.$$.dirty[0]&128&&l(19,i=F-Ye*2),t.$$.dirty[0]&134217730&&l(18,a=S==C),t.$$.dirty[0]&18&&l(9,s=Z==null?void 0:Z.bifurcations[S]),t.$$.dirty[0]&872415232&&l(17,n=p.topOffset+p.totalSize-p.totalSize*(H+z)),t.$$.dirty[0]&335544320&&l(11,o=p.totalSize*H),t.$$.dirty[0]&4&&l(16,r=v*.02),t.$$.dirty[0]&2048&&l(15,u=o*.03),t.$$.dirty[0]&132&&l(12,c=v*.85/F),t.$$.dirty[0]&4096&&l(10,h=et*c),t.$$.dirty[0]&3072&&l(14,_=o/h),t.$$.dirty[0]&1073742336&&l(31,I=U[s==null?void 0:s.attribute_kind]||{}),t.$$.dirty[1]&1&&l(13,g=Object.keys(I)),t.$$.dirty[0]&258&&(d=>{l(0,j[S].show_top=d=="highest",j)})(q)},[j,S,v,X,Z,W,V,F,q,s,h,o,c,g,_,u,r,n,a,i,Y,R,E,G,P,ie,p,C,H,z,U,I,O,re,m,w]}class Wl extends De{constructor(e){super(),Ne(this,e,Bl,Ll,je,{lVis:26,index:1,expandedIndex:27,childRate:28,overHangRate:29,sideBarWidth:2,svgWidth:3,currentQcSpec:4,controlSpecs:0,attributeLabels:30,maxOnOneLevel:5,minShow:6,controlHtmlWidth:7},null,[-1,-1])}}function Ot(t,e,l){const i=t.slice();return i[46]=e[l],i[48]=l,i}function It(t,e,l){const i=t.slice();return i[49]=e[l][0],i[50]=e[l][1],i}function Mt(t){var re;let e,l,i,a,s,n,o,r,u,c,h,_,I="Infobox on Hover",g,p,S,C,H,z,v,X,Z,j,U,W,V,F=!1,Y=ce(Object.entries(t[17])),R=[];for(let m=0;m<Y.length;m+=1)R[m]=yt(It(t,Y,m));function E(m){t[32](m)}let G={values:[!0,!1],labels:["On","Off"]};t[4]!==void 0&&(G.value=t[4]),p=new it({props:G}),qe.push(()=>Qe(p,"value",E));let q=ce(t[19]||[]),P=[];for(let m=0;m<q.length;m+=1)P[m]=Rt(Ot(t,q,m));const ie=m=>J(P[m],1,1,()=>{P[m]=null});v=new Ht({props:{qcSpec:t[6],branchReachBack:t[20],xOffset:t[25],rootWidth:Ge,attributeLabels:t[9],visibleTreeInfo:t[13],selectionState:t[12],levelVisuals:t[19],treeWidth:t[23],treeXOffset:t[24],childRate:t[16],overHangRate:Vt,childBaseSize:Vl}}),v.$on("ti",t[27]),Z=new lt({props:{height:t[20]-2,width:Ge,text:((re=t[8])==null?void 0:re.name)||"",anchor:"middle"}});let O=t[18]!=null&&Tt(t);return{c(){e=x("svg"),l=x("rect"),a=x("rect"),n=x("foreignObject"),o=ee("div"),r=ee("div"),u=ee("select");for(let m=0;m<R.length;m+=1)R[m].c();c=ne(),h=ee("div"),_=ee("span"),_.textContent=I,g=ne(),de(p.$$.fragment),C=ne();for(let m=0;m<P.length;m+=1)P[m].c();z=Me(),de(v.$$.fragment),X=x("g"),de(Z.$$.fragment),O&&O.c(),this.h()},l(m){e=$(m,"svg",{viewBox:!0,xmlns:!0});var w=B(e);l=$(w,"rect",{fill:!0,"fill-opacity":!0,x:!0,y:!0,height:!0,width:!0}),B(l).forEach(b),a=$(w,"rect",{id:!0,y:!0,x:!0,width:!0,height:!0,class:!0}),B(a).forEach(b),n=$(w,"foreignObject",{y:!0,width:!0,height:!0,transform:!0});var d=B(n);o=te(d,"DIV",{style:!0});var k=B(o);r=te(k,"DIV",{id:!0,class:!0});var le=B(r);u=te(le,"SELECT",{class:!0});var ae=B(u);for(let be=0;be<R.length;be+=1)R[be].l(ae);ae.forEach(b),le.forEach(b),c=se(k),h=te(k,"DIV",{id:!0,class:!0});var D=B(h);_=te(D,"SPAN",{class:!0,"data-svelte-h":!0}),Wt(_)!=="svelte-1amfah6"&&(_.textContent=I),g=se(D),ge(p.$$.fragment,D),D.forEach(b),C=se(k),k.forEach(b),d.forEach(b);for(let be=0;be<P.length;be+=1)P[be].l(w);z=Me(),ge(v.$$.fragment,w),X=$(w,"g",{style:!0});var fe=B(X);ge(Z.$$.fragment,fe),fe.forEach(b),O&&O.l(w),w.forEach(b),this.h()},h(){f(l,"fill","grey"),f(l,"fill-opacity",.3),f(l,"x",0),f(l,"y",i=-t[20]),f(l,"height",t[20]),f(l,"width",Ie),f(a,"id","qc-header"),f(a,"y",s=-t[20]),f(a,"x",t[25]),f(a,"width",Ge),f(a,"height",t[20]),f(a,"class","svelte-14evmle"),f(u,"class","svelte-14evmle"),t[5]===void 0&&ye(()=>t[31].call(u)),f(r,"id","qc-type-selector"),f(r,"class","svelte-14evmle"),f(_,"class","svelte-14evmle"),f(h,"id","hover-check"),f(h,"class","svelte-14evmle"),T(o,"padding","20px"),f(n,"y",H=-t[20]/ke),f(n,"width",We/ke),f(n,"height",500),f(n,"transform","scale("+ke+","+ke+")"),T(X,"--x-off",t[25]+Ge/2+"px"),T(X,"--y-off","-1px"),f(e,"viewBox",j="0 "+(-t[20]-t[21])+" "+Ie+" "+t[14]),f(e,"xmlns","http://www.w3.org/2000/svg")},m(m,w){Q(m,e,w),L(e,l),L(e,a),L(e,n),L(n,o),L(o,r),L(r,u);for(let d=0;d<R.length;d+=1)R[d]&&R[d].m(u,null);st(u,t[5],!0),L(o,c),L(o,h),L(h,_),L(h,g),pe(p,h,null),L(o,C);for(let d=0;d<P.length;d+=1)P[d]&&P[d].m(e,null);L(e,z),pe(v,e,null),L(e,X),pe(Z,X,null),O&&O.m(e,null),U=!0,W||(V=ve(u,"change",t[31]),W=!0)},p(m,w){var ae;if((!U||w[0]&1048576&&i!==(i=-m[20]))&&f(l,"y",i),(!U||w[0]&1048576)&&f(l,"height",m[20]),(!U||w[0]&1048576&&s!==(s=-m[20]))&&f(a,"y",s),(!U||w[0]&1048576)&&f(a,"height",m[20]),w[0]&131072){Y=ce(Object.entries(m[17]));let D;for(D=0;D<Y.length;D+=1){const fe=It(m,Y,D);R[D]?R[D].p(fe,w):(R[D]=yt(fe),R[D].c(),R[D].m(u,null))}for(;D<R.length;D+=1)R[D].d(1);R.length=Y.length}w[0]&131104&&st(u,m[5]);const d={};if(!S&&w[0]&16&&(S=!0,d.value=m[4],Ae(()=>S=!1)),p.$set(d),(!U||w[0]&1048576&&H!==(H=-m[20]/ke))&&f(n,"y",H),w[0]&67700296){q=ce(m[19]||[]);let D;for(D=0;D<q.length;D+=1){const fe=Ot(m,q,D);P[D]?(P[D].p(fe,w),A(P[D],1)):(P[D]=Rt(fe),P[D].c(),A(P[D],1),P[D].m(e,z))}for(Se(),D=q.length;D<P.length;D+=1)ie(D);Ee()}const k={};w[0]&64&&(k.qcSpec=m[6]),w[0]&1048576&&(k.branchReachBack=m[20]),w[0]&512&&(k.attributeLabels=m[9]),w[0]&8192&&(k.visibleTreeInfo=m[13]),w[0]&4096&&(k.selectionState=m[12]),w[0]&524288&&(k.levelVisuals=m[19]),w[0]&65536&&(k.childRate=m[16]),v.$set(k);const le={};w[0]&1048576&&(le.height=m[20]-2),w[0]&256&&(le.text=((ae=m[8])==null?void 0:ae.name)||""),Z.$set(le),m[18]!=null?O?(O.p(m,w),w[0]&262144&&A(O,1)):(O=Tt(m),O.c(),A(O,1),O.m(e,null)):O&&(Se(),J(O,1,1,()=>{O=null}),Ee()),(!U||w[0]&3162112&&j!==(j="0 "+(-m[20]-m[21])+" "+Ie+" "+m[14]))&&f(e,"viewBox",j)},i(m){if(!U){A(F),A(p.$$.fragment,m);for(let w=0;w<q.length;w+=1)A(P[w]);A(v.$$.fragment,m),A(Z.$$.fragment,m),A(O),U=!0}},o(m){J(F),J(p.$$.fragment,m),P=P.filter(Boolean);for(let w=0;w<P.length;w+=1)J(P[w]);J(v.$$.fragment,m),J(Z.$$.fragment,m),J(O),U=!1},d(m){m&&b(e),Ve(R,m),me(p),Ve(P,m),me(v),me(Z),O&&O.d(),W=!1,V()}}}function yt(t){let e,l=t[50].title+"",i,a,s;return{c(){e=ee("option"),i=Te(l),a=ne(),this.h()},l(n){e=te(n,"OPTION",{class:!0});var o=B(e);i=Ce(o,l),a=se(o),o.forEach(b),this.h()},h(){e.__value=s=t[49],Ue(e,e.__value),f(e,"class","svelte-14evmle")},m(n,o){Q(n,e,o),L(e,i),L(e,a)},p(n,o){o[0]&131072&&l!==(l=n[50].title+"")&&ze(i,l),o[0]&131072&&s!==(s=n[49])&&(e.__value=s,Ue(e,e.__value))},d(n){n&&b(e)}}}function Rt(t){let e,l,i;function a(n){t[33](n)}let s={lVis:t[46],index:t[48],childRate:t[16],overHangRate:Vt,sideBarWidth:We,svgWidth:Ie,currentQcSpec:t[6],expandedIndex:t[3],attributeLabels:t[9]};return t[10]!==void 0&&(s.controlSpecs=t[10]),e=new Wl({props:s}),qe.push(()=>Qe(e,"controlSpecs",a)),e.$on("ce",t[26]),{c(){de(e.$$.fragment)},l(n){ge(e.$$.fragment,n)},m(n,o){pe(e,n,o),i=!0},p(n,o){const r={};o[0]&524288&&(r.lVis=n[46]),o[0]&65536&&(r.childRate=n[16]),o[0]&64&&(r.currentQcSpec=n[6]),o[0]&8&&(r.expandedIndex=n[3]),o[0]&512&&(r.attributeLabels=n[9]),!l&&o[0]&1024&&(l=!0,r.controlSpecs=n[10],Ae(()=>l=!1)),e.$set(r)},i(n){i||(A(e.$$.fragment,n),i=!0)},o(n){J(e.$$.fragment,n),i=!1},d(n){me(e,n)}}}function Tt(t){var o;let e,l,i,a,s,n;return a=new ol({props:{path:t[2],weightedRoot:t[11],specBaselineOptions:t[7],attributeLabels:t[9],qcSpec:t[6],rootId:(o=t[8])==null?void 0:o.id}}),{c(){e=x("g"),l=x("rect"),i=x("foreignObject"),de(a.$$.fragment),this.h()},l(r){e=$(r,"g",{style:!0});var u=B(e);l=$(u,"rect",{id:!0,height:!0,width:!0,fill:!0,"fill-opacity":!0,stroke:!0,"stroke-width":!0,rx:!0,class:!0}),B(l).forEach(b),i=$(u,"foreignObject",{height:!0,width:!0,transform:!0});var c=B(i);ge(a.$$.fragment,c),c.forEach(b),u.forEach(b),this.h()},h(){f(l,"id","hover-rect"),f(l,"height",Ze),f(l,"width",t[22]),f(l,"fill","var(--color-theme-white)"),f(l,"fill-opacity","0.85"),f(l,"stroke","black"),f(l,"stroke-width","0.1px"),f(l,"rx","0.2"),f(l,"class","svelte-14evmle"),f(i,"height",Ze/ke),f(i,"width",t[22]/ke),f(i,"transform","scale("+ke+","+ke+")"),T(e,"--x-off",t[18].position.x-t[22]+"px"),T(e,"--y-off",t[18].position.y-Ze+"px")},m(r,u){Q(r,e,u),L(e,l),L(e,i),pe(a,i,null),n=!0},p(r,u){var h;const c={};u[0]&4&&(c.path=r[2]),u[0]&2048&&(c.weightedRoot=r[11]),u[0]&128&&(c.specBaselineOptions=r[7]),u[0]&512&&(c.attributeLabels=r[9]),u[0]&64&&(c.qcSpec=r[6]),u[0]&256&&(c.rootId=(h=r[8])==null?void 0:h.id),a.$set(c),(!n||u[0]&262144)&&T(e,"--x-off",r[18].position.x-r[22]+"px"),(!n||u[0]&262144)&&T(e,"--y-off",r[18].position.y-Ze+"px")},i(r){n||(A(a.$$.fragment,r),r&&ye(()=>{n&&(s||(s=ue(e,_e,{duration:100},!0)),s.run(1))}),n=!0)},o(r){J(a.$$.fragment,r),r&&(s||(s=ue(e,_e,{duration:100},!1)),s.run(0)),n=!1},d(r){r&&b(e),me(a),r&&s&&s.end()}}}function zl(t){let e,l=![t[20],Ie,t[14]].includes(NaN),i,a,s;ye(t[30]);let n=l&&Mt(t);return{c(){e=ee("div"),n&&n.c(),this.h()},l(o){e=te(o,"DIV",{class:!0});var r=B(e);n&&n.l(r),r.forEach(b),this.h()},h(){f(e,"class","treefix svelte-14evmle")},m(o,r){Q(o,e,r),n&&n.m(e,null),i=!0,a||(s=ve(window,"resize",t[30]),a=!0)},p(o,r){r[0]&1064960&&(l=![o[20],Ie,o[14]].includes(NaN)),l?n?(n.p(o,r),r[0]&1064960&&A(n,1)):(n=Mt(o),n.c(),A(n,1),n.m(e,null)):n&&(Se(),J(n,1,1,()=>{n=null}),Ee())},i(o){i||(A(n),i=!0)},o(o){J(n),i=!1},d(o){o&&b(e),n&&n.d(),a=!1,s()}}}const Ct=.3;let Ie=100,Ge=25,We=17,Vt=.05,Pl=.03,Lt=.12,Hl=.85,Vl=2.5,Ze=12.5,ke=.035;function jl(t,e){let l=new RegExp("\\{pc_id\\}","gi");return t.replace(l,e)}function ql(t,e,l){let i,a,s,n,o,r,u,c;Ft(t,Jt,y=>l(36,c=y));const h={ce:y=>le(parseInt(y)),se:y=>ae(y.split("-")),sp:y=>{const N=parseInt(y);N<m.length&&l(10,m[N].size_base="specialization",m)},qc:y=>{Object.keys(W).includes(y)&&l(5,F=y)},mi:y=>{const N=parseInt(y.slice(0,1));N<m.length&&l(10,m[N].include=y.slice(1).split(","),m)}};async function _(y){if(y.length!=0)for(const N of y.split(";")){const K=N.slice(0,2),we=N.slice(2);if(console.log("parsed comm",K,we),K=="sl")await new Promise(he=>setTimeout(he,parseFloat(we)*1e3));else{const he=h[K];he!=null&&he(we)}}}let I=[],g,p,S=[],C=[],H,z=Ct,v=!0,X=We*.85,Z=Ie-We-2,j=We+1,U=Z*.15+We,W={},V=[],F,Y,R={},E,G,q={};const P=y=>({id:y[0],name:y[1].title});Gt(()=>{rt("root-descriptions",y=>{E=y[c.params.rootType],l(8,G=E.filter(N=>N.id==c.params.rootId)[0])}),ll().then(([y,N,K])=>{l(17,W=Object.fromEntries(Object.entries(N).filter(([we,he])=>he.root_entity_type==c.params.rootType))),V=Object.entries(W).map(P),l(5,F=V[0].id),l(9,q=y),l(7,R=K),_(c.url.searchParams.get("e")||"")})});function ie(y,N){y==null||N==null||(console.log(`qc${y}`),el(`${tl}/view/${c.params.rootType}/${N}${c.url.search}`),rt(`qc-builds/${y}/${N}`,K=>{l(11,[w,m,d,Y,m]=[K,m,{children:{}},W[F],re(y,N)],w,l(10,m),l(12,d),l(6,Y))}))}function O(y,N,K){return N&&y.length>0?{node:Je(y,o.tree),position:K}:void 0}function re(y,N){const K=[];for(var we of W[y].bifurcations)K.push({...ot,...JSON.parse(jl(we.control_format_str,N))});return K}let m=[ot],w={weight:1},d={children:{}},k={x:0,y:0};function le(y){y==H?(l(3,H=void 0),l(16,z=Ct)):(l(3,H=y),l(16,z=.5))}function ae(y){var he;I.push(`se${y.join("-")}`),console.log(I.join(";"));const N=y[y.length-1];let K=Je(y.slice(0,y.length-1),d);if((K==null?void 0:K.children)===void 0)return;Object.keys(K.children).includes(N)?(delete K.children[N],l(15,C=sl(d))):(l(15,C=y),K.children[N]={children:((he=K.children[N])==null?void 0:he.children)||{}}),l(12,d)}const D=y=>le(y.detail.ind);function fe(y){const N=y.detail.path,K=y.detail.action;if(K=="highlight"){l(28,[k,S]=[y.detail.topLeftCorner,N],k,l(2,S));return}else if(K=="de-highlight"){l(2,S=[]);return}ae(N)}function be(){l(1,p=window.innerWidth),l(0,g=window.innerHeight)}function M(){F=Zt(this),l(5,F),l(17,W)}function oe(y){v=y,l(4,v)}function Oe(y){m=y,l(10,m)}return t.$$.update=()=>{t.$$.dirty[0]&3&&l(14,i=g/p*Ie-5),t.$$.dirty[0]&16384&&l(21,a=i*Pl),t.$$.dirty[0]&16384&&l(20,s=i*Lt),t.$$.dirty[0]&16384&&l(29,n=i*(1-Lt)*Hl),t.$$.dirty[0]&288&&ie(F,G==null?void 0:G.id),t.$$.dirty[0]&8128&&l(13,o=il(G==null?void 0:G.id,w,m,d,q,Y,R)),t.$$.dirty[0]&536879112&&l(19,r=nl(o,n,H)),t.$$.dirty[0]&268435476&&l(18,u=O(S,v,k))},[g,p,S,H,v,F,Y,R,G,q,m,w,d,o,i,C,z,W,u,r,s,a,X,Z,j,U,D,fe,k,n,be,M,oe,Oe]}class Jl extends De{constructor(e){super(),Ne(this,e,ql,zl,je,{},null,[-1,-1])}}export{Jl as component};
